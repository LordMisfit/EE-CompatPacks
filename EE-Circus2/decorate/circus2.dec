actor BloodNonSolid : Blood
{
	-SOLID
	+CANNOTPUSH
}

// Items
actor RedBalloon replaces Balloon_Red 3112
{
	//$Angled
	//$Color 11
	//$Category "Happy Time Circus/Balloons"

	Radius 12
	Height 40
	HEALTH 1
	Mass 25
	+SHOOTABLE
	+NOGRAVITY
	+HEXENBOUNCE
	+PUSHABLE
	+FLOATBOB
	+SPAWNFLOAT
	+NOLIFTDROP
	+DONTOVERLAP
	+CANNOTPUSH
	+NOBLOCKMONST
	PainSound "pop1"
	DeathSound "pop1"
	States
	{
		SpawnBlue:
			TNT1 A 0 A_SpawnItemEx("BlueBalloon",0,0,0,0,0,0,0,0,0,tid)
			TNT1 A 0 A_FadeOut(1.0)
			stop
		SpawnGreen:
			TNT1 A 0 A_SpawnItemEx("GreenBalloon",0,0,0,0,0,0,0,0,0,tid)
			TNT1 A 0 A_FadeOut(1.0)
			stop
		SpawnYellow:
			TNT1 A 0 A_SpawnItemEx("YellowBalloon",0,0,0,0,0,0,0,0,0,tid)
			TNT1 A 0 A_FadeOut(1.0)
			stop
		Spawn:
			TNT1 A 0 NoDelay A_Jump(16,"SpawnGreen","SpawnBlue","SpawnYellow")
			BOON A 4 A_Look
			goto Spawn+1
		See:
			BOON A 4 A_Chase
			Loop
		Pain: Goto See
		Death:
			BOON B 2 A_Scream
			TNT1 A 0
			{
				/*
				if (random(1,256) <= 192)
				{
				}
				*/
			}
			BOON C 2 A_Fall
			BOON D 2 A_CustomMissile("BSplatter", 40, 0, 0, 1)
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			BOON E 2
			BOON F 2
			BOON G 2
			Stop
	}
}
actor RedBalloon2 : RedBalloon replaces Balloon_Red2 3114
{
	//$Angled
	//$Color 11
	//$Category "Happy Time Circus/Balloons"

	+SHOOTABLE -NOGRAVITY -HEXENBOUNCE +PUSHABLE -FLOATBOB -SPAWNFLOAT
	-NOLIFTDROP -DONTOVERLAP +CANNOTPUSH +NOBLOCKMONST +CANPASS +DROPOFF
}

actor YellowBalloon replaces Balloon_Yellow 3113
{
	//$Angled
	//$Color 11
	//$Category "Happy Time Circus/Balloons"

	Radius 12
	Height 40
	HEALTH 1
	Mass 25
	+SHOOTABLE +NOGRAVITY +HEXENBOUNCE +PUSHABLE +FloatBob +SPAWNFLOAT 
	+NOLIFTDROP +NOBLOOD +DONTOVERLAP +CANNOTPUSH +NOBLOCKMONST     

	// Has a tiny chance to drop a weapon
	PainSound "pop1"
	DeathSound "pop1"
	States
	{
		SpawnRed:
			TNT1 A 0 A_SpawnItemEx("RedBalloon",0,0,0,0,0,0,0,0,0,tid)
			TNT1 A 0 A_FadeOut(1.0)
			stop
		SpawnBlue:
			TNT1 A 0 A_SpawnItemEx("BlueBalloon",0,0,0,0,0,0,0,0,0,tid)
			TNT1 A 0 A_FadeOut(1.0)
			stop
		SpawnGreen:
			TNT1 A 0 A_SpawnItemEx("GreenBalloon",0,0,0,0,0,0,0,0,0,tid)
			TNT1 A 0 A_FadeOut(1.0)
			stop
		Spawn:
			TNT1 A 0 NoDelay A_Jump(16,"SpawnGreen","SpawnBlue","SpawnRed")
			BNYL A 4 
			Loop
		See:
			BNYL A 4 
			Loop
		Pain: Goto See
		Death:
			BNYL B 2 A_Scream
			BNYL B 0
			{
				// Drop Tables Here V:
			}
			BNYL C 2 A_Fall
			BNYL DEF 2   
			Stop
	}
}

actor GreenBalloon replaces Balloon_Green 3116
{
	//$Angled
	//$Color 11
	//$Category "Happy Time Circus/Balloons"

	Radius 12
	Height 40
	HEALTH 1
	Mass 25
	+SHOOTABLE 
	+NOGRAVITY
	+HEXENBOUNCE
	+PUSHABLE 
	+FloatBob
	+SPAWNFLOAT 
	+NOLIFTDROP
	+NOBLOOD
	+DONTOVERLAP
	+CANNOTPUSH
	+NOBLOCKMONST 
	DropItem "Clip", 51
	DropItem "ClipBox", 10
	DropItem "Shell", 51
	DropItem "ShellBox", 10
	DropItem "RocketAmmo", 51
	DropItem "RocketBox", 10
	DropItem "Cell", 51
	DropItem "CellPack", 10
	DropItem "HealthBonus", 40
	DropItem "HealthBonus", 8
	DropItem "ArmorBonus", 40
	DropItem "ArmorBonus", 8
	DropItem "Berserk", 1
	DropItem "Medikit", 5
	DropItem "Medikit", 1
	DropItem "Stimpack", 10
	DropItem "Stimpack", 2
	PainSound "pop1"
	DeathSound "pop1"
	States
	{
		SpawnRed:
			TNT1 A 0 A_SpawnItemEx("RedBalloon",0,0,0,0,0,0,0,0,0,tid)
			TNT1 A 0 A_FadeOut(1.0)
			stop
		SpawnBlue:
			TNT1 A 0 A_SpawnItemEx("BlueBalloon",0,0,0,0,0,0,0,0,0,tid)
			TNT1 A 0 A_FadeOut(1.0)
			stop
		SpawnYellow:
			TNT1 A 0 A_SpawnItemEx("YellowBalloon",0,0,0,0,0,0,0,0,0,tid)
			TNT1 A 0 A_FadeOut(1.0)
			stop
		Spawn:
			TNT1 A 0 NoDelay A_Jump(16,"SpawnBlue","SpawnYellow","SpawnRed")
			GBON A 4 
			goto Spawn+1
		See:
			GBON A 4 
			Loop
		Pain: Goto See
		Death:
			GBON B 0
			{
				// Drop Table
			}
			GBON B 2 A_Scream
			GBON C 2 A_Fall
			GBON DEFG 3   
			Stop
	}
}

actor BlueBalloon replaces Balloon_Blue 3193
{
	//$Angled
	//$Color 11
	//$Category "Happy Time Circus/Balloons"

	Radius 12
	Height 40
	HEALTH 1
	Mass 25
	+SHOOTABLE +NOGRAVITY +HEXENBOUNCE +PUSHABLE +FloatBob +SPAWNFLOAT 
	+NOLIFTDROP +NOBLOOD +DONTOVERLAP +CANNOTPUSH +NOBLOCKMONST 
	DropItem "HealthBonus", 64
	DropItem "HealthBonus", 64
	DropItem "HealthBonus", 64
	DropItem "HealthBonus", 64
	DropItem "HealthBonus", 64
	DropItem "HealthBonus", 64
	DropItem "HealthBonus", 64
	DropItem "HealthBonus", 64
	DropItem "SoulSphere", 8
	DropItem "MegaSphere", 8

	PainSound "pop1"
	DeathSound "pop1"
	States
	{
		SpawnRed:
			TNT1 A 0 A_SpawnItemEx("RedBalloon",0,0,0,0,0,0,0,0,0,tid)
			TNT1 A 0 A_FadeOut(1.0)
			stop
		SpawnGreen:
			TNT1 A 0 A_SpawnItemEx("GreenBalloon",0,0,0,0,0,0,0,0,0,tid)
			TNT1 A 0 A_FadeOut(1.0)
			stop
		SpawnYellow:
			TNT1 A 0 A_SpawnItemEx("YellowBalloon",0,0,0,0,0,0,0,0,0,tid)
			TNT1 A 0 A_FadeOut(1.0)
			stop
		Spawn:
			TNT1 A 0 NoDelay A_Jump(16,"SpawnGreen","SpawnYellow","SpawnRed")
			BLUB A 4 
			goto Spawn+1
		See:
			BLUB A 4 
			Loop
		Pain: Goto See
		Death:
			BLUB B 2 A_Scream
			BLUB C 2 A_Fall
			BLUB DEF 3   
			Stop
	}
}

//=========================================================================
actor SkullSeeker : EEProjectile
{
	Tag "Skull Seeker"
	Radius 8
	Height 6
	Speed 9
	Damage (6 * random(1,8))
	Scale 0.3
	+SEEKERMISSILE
	PROJECTILE
	SeeSound "BHIT5"
	DeathSound "BHIT3"
	States
	{
		Spawn:
			GHST AB 4 A_SeekerMissile (5,20)
			Loop
		Death:
			GHST CDEFG 4 Bright
			Stop
	}
}

ACTOR JumpingSkullNew : EECreature replaces JumpingSkull 32121
{
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Bouncing Skull"

	Health 40
	Radius 8
	Height 20
	Speed 9
	Mass 20
	PainChance 90
	Painchance "Fist", 135 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 225 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Zap", 1.25
	Painchance "Zap", 112
	DamageFactor "Cricket", 2.0
	Painchance "Cricket", 180
	DamageFactor "Bonk", 2.0
	Painchance "Bonk", 180
	DamageFactor "CherryBomb", 1.334
	Painchance "CherryBomb", 120
	DamageFactor "Spinner", 1.334
	Painchance "Spinner", 120
	DamageFactor "BRocket", 1.334
	Painchance "BRocket", 120
	DamageFactor "Popper", 0.667
	Painchance "Popper", 60
	MONSTER 
	+FLOORCLIP +RANDOMIZE +COUNTKILL +CANPASS
	MELEEDAMAGE 1
	MeleeRange 25
	SeeSound "LAUGH1"
	PainSound "SKULPN2"
	DeathSound "JDIE"
	ActiveSound "LAUGH1"
	MeleeSound "SKULBITE"
	HitObituary "%o was bitten by a bouncing skull."

	dropitem GreenArmor 2
	dropitem BlueArmor 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	States
	{
		Spawn:
			JSKL A 0 NoDelay //
			JSKL A 4 A_Look
			goto Spawn+1
		See:
			JSKL A 0 
			JSKL ABCB 2
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Loop
		Melee:
			TNT1 A 0
			JSKL AB 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			JSKL C 4
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
				
				A_CustomMeleeAttack(random(2,6)*1,"SKULBITE","none");
			}
			JSKL B 3  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			Goto See
		Pain:
			JSKL B 4 A_EEPain
			Goto See
		Death:
			TNT1 A 0 //
			JSKL A 5 A_Scream
			JSKL D 4 A_Fall
			JSKL D 4 A_TossGib
			JSKL D 0 A_TossGib
			JSKL D 0 A_TossGib
			JSKL D 0 A_TossGib
			JSKL D 0 A_TossGib
			JSKL E 8 A_CustomMissile("ZGut2", 0, 0, 30) 
			JSKL F 8 A_CustomMissile("ZGut3", 0, 0, -40) 
			JSKL G 8 A_CustomMissile("ZGut2", 0, 0, 90) 
			JSKL H 8 A_CustomMissile("ZGut3", 0, 0, 180) 
			JSKL I -1 
			Stop
		Ice:
			JSKL B 5 A_GenericFreezeDeath
			JSKL B 1 A_FreezeDeathChunks
			wait
		Raise:
			JSKL H 8 //
			JSKL GFED 8
			goto See
	}
}
//
actor PennywiseHeadProj : EEProjectile
{ 
	Tag "Evil Clown Spirit"
	Health 2
	Speed 2 
	+FloatBob +NOGRAVITY 
	MELEEDAMAGE 1
	RENDERSTYLE Translucent
	ALPHA 0.25
	scale 0.25
	MeleeSound ""
	Obituary "%o got killed by an evil clown-shaped spirit." 
	States 
	{
		Spawn: 
			CFHD AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 4 A_Look
			goto Dissipate
		See: 
			CFHD ADED 3 A_Chase
			CFHD ADED 3 A_CStaffMissileSlither 
			CFHD ADED 3 A_BishopMissileWeave
			CFHD ADED 3 A_Chase
			CFHD ADED 3 A_CStaffMissileSlither
			CFHD ADED 3 A_Wander
			CFHD ADED 3 A_BishopMissileWeave
			CFHD ADED 3 A_CStaffMissileSlither
			CFHD ADED 3 A_Chase
			CFHD ADED 3 A_BishopMissileWeave
			CFHD ADED 3 A_Wander
			CFHD ADED 3 A_CStaffMissileSlither
			goto Dissipate
		Melee:
			CFHD D 4 A_FaceTarget  
			CFHD E 3 A_FaceTarget 
			CFHD D 3 A_CustomMeleeAttack((1*random(1,10)))
			CFHD A 3 A_FaceTarget 
			goto Dissipate
		Dissipate:
			CFHD FGHIJKLMN 4
			Stop
	}
}

ACTOR JumpingSkull2New : EECreature replaces JumpingSkull2 3646 //spawns skull ghosts
{
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Bouncing Skull"

	Health 40
	Speed 10
	Radius 8
	Height 32
	MELEEDAMAGE 1
	MeleeRange 22
	MeleeSound "BCHOMP"
	Scale 1.2
	PainChance 70
	Painchance "Fist", 105 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 175 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Zap", 1.25
	Painchance "Zap", 88
	DamageFactor "Cricket", 2.0
	Painchance "Cricket", 140
	DamageFactor "Bonk", 2.0
	Painchance "Bonk", 140
	DamageFactor "CherryBomb", 1.334
	Painchance "CherryBomb", 93
	DamageFactor "Spinner", 1.334
	Painchance "Spinner", 93
	DamageFactor "BRocket", 1.334
	Painchance "BRocket", 93
	DamageFactor "Popper", 0.667
	Painchance "Popper", 47
	MONSTER
	RENDERSTYLE Translucent
	ALPHA 0.67

	dropitem GreenArmor 2
	dropitem BlueArmor 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	States
	{
		Spawn:
			JSKL A 0 NoDelay 
			JSKL A 4 A_Look
			goto Spawn+1
		See:
			JSKL A 0 
			JSKL ABCB 2
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			JSKL A 0 
			{
				A_SpawnProjectile("PennywiseHeadProj", 8, 0, random(-180, 180), 2, random(0, 30));
			}
			Loop
		Melee:
			TNT1 A 0
			JSKL AB 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			JSKL C 4
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
				
				A_CustomMeleeAttack(random(3,8)*1,"SKULBITE","none");
			}
			JSKL B 3  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			Goto See
		Pain:
			JSKL B 4 A_EEPain
			Goto See
		Death:
			TNT1 A 0 
			JSKL A 5 A_Scream
			JSKL D 4 A_Fall
			JSKL D 4 A_TossGib
			BBLD A 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			JSKL D 0 A_TossGib
			JSKL D 0 A_TossGib
			JSKL D 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			JSKL D 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			JSKL D 0 A_TossGib
			JSKL D 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			JSKL D 0 A_TossGib
			JSKL D 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			JSKL E 8 A_CustomMissile("ZGut2", 0, 0, 30) 
			JSKL F 8 A_CustomMissile("ZGut3", 0, 0, -40) 
			JSKL G 8 A_CustomMissile("ZGut2", 0, 0, 90) 
			JSKL H 8 A_CustomMissile("ZGut3", 0, 0, 180) 
			JSKL I -1 
			Stop
		Ice:
			JSKL B 5 A_GenericFreezeDeath
			JSKL B 1 A_FreezeDeathChunks
			wait
	}
}

ACTOR PossessedBalloonNew : EECreature replaces PossessedBalloon 3115
{
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Possessed Balloon"
	EECreature.ActorFamily "Balloon"

	Health 15
	Radius 15
	Height 40
	Speed 2
	FloatSpeed 3
	Mass 20
	PainChance 50
	Painchance "Fist", 75 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 125 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Zap", 1.5
	Painchance "Zap", 75
	DamageFactor "Suck", 0.05
	PainChance "Suck", 2
	MONSTER 
	+LOOKALLAROUND
	+FLOORCLIP
	+NOGRAVITY
	+FLOAT
	+COUNTKILL
	+CANPASS
	+PUSHABLE
	+FloatBob
	MELEEDAMAGE 1
	MeleeRange 28
	SeeSound ""
	PainSound "BOONBITE"
	DeathSound ""
	ActiveSound "BLOONACT"
	MeleeSound "BOONBITE"
	HitObituary "%o wanted to float with all the pretty balloons."

	dropitem GreenArmor 1
	dropitem BlueArmor 1
	dropitem HealthBonus 1
	dropitem HealthBonus 1
	dropitem ArmorBonus 1
	dropitem ArmorBonus 1
	States
	{
		Spawn:
			BSTN A 0 NoDelay 
			BSTN A 2 A_FloatLook(16)
			goto Spawn+1
		See:
			BSTN A 0
			BSTN A 2
			{
				A_FloatChaseCheck(4,8,12,16,0.67,0.67);
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Loop
		Melee:
			TNT1 A 0
			BSTN BC 4
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			BSTN D 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
				
				A_CustomMeleeAttack(random(1,6)*1,"BOONBITE","none");
			}
			BSTN CB 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			Goto See
		Pain:
			BSTN B 3 A_FloatPain(0,8,32)
			Goto See
		Death:
			TNT1 A 0 
			BSTN B 3
			BSTN C 3 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BSTN D 3 A_Scream
			BSTN DDDDDD 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BSTN E 3 A_Fall
			BSTN EEEEE 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			TNT1 A 0 A_CustomMissile("BSplatter", 40, 0, 0, 1)
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
			BSTN F 3 A_CustomMissile("BalloonSoul", 28, 0, random(-180, 180), 2, random(-15, 80))
			BSTN GHIJKLM 3
			Stop
		Ice:
			BSTN B 5 A_GenericFreezeDeath
			BSTN B 1 A_FreezeDeathChunks
			wait
	}
}

//
actor RevRocketNew : EEProjectile replaces RevRocket
{
	Tag "Happy Gas Rocket"
	Radius 8
	Height 6
	Speed 12
	Damage (2 * random(1,8))
	Scale 0.55
	+SEEKERMISSILE
	PROJECTILE
	SeeSound "REVRCK"
	DeathSound "EXPLODE"
	ExplosionRadius 96
	ExplosionDamage 12
	States
	{
		Spawn:
			RRCK A 1 A_SeekerMissile (30,40)
			RRCK A 1 A_CustomMissile("RevTrail",0, 0, 0)
			RRCK A 1 A_StartSound("HISS")
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), 2, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)  
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), 2, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)  
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1) 
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), 2, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)  
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)  
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), 2, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), 2, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)  
			Loop
		Death:
			GLOB A 4 Bright 
			GLOB B 4 Bright A_Explode(12,96,0)
			GLOB B 2 Bright A_CustomMissile("HappyCloud", 16, 8, 135, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB BBBBBBB 0 A_CustomMissile("Sparkles", 4,4, random(-180, 180), 2, random(-180, 180))
			GLOB B 2 Bright A_CustomMissile("HappyCloud", 12, 0, 90, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB B 2 Bright A_CustomMissile("HappyCloud", 16, -8, -135, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB C 2 Bright A_CustomMissile("HappyCloud", 16, 0, -200, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB CCCCCCC 0 A_CustomMissile("Sparkles", 4, 4, random(-180, 180), 2, random(-180, 180))
			GLOB D 2 Bright A_CustomMissile("HappyCloud", 18, 0, 45, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB E 2 Bright A_CustomMissile("HappyCloud", 16, 8, 300, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB E 2 Bright A_CustomMissile("HappyCloud", 16, 0, 200, CMF_AIMOFFSET|CMF_TRACKOWNER)
			GLOB EEEEEEE 0 A_CustomMissile("Sparkles", 4, 4, random(-180, 180), 2, random(-180, 180))
			GLOB F 2 Bright A_CustomMissile("HappyCloud", 22, -8, 315, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB G 2 Bright A_CustomMissile("HappyCloud", 16, 0, 270, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB G 2 Bright A_CustomMissile("HappyCloud", 12, 8, 180, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB H 4 Bright 
			Stop
	}
}

actor HappyCloud : EEProjectile
{ 
	Tag "Happy Gas"
	Radius 32 
	Height 32 
	Speed 3 
	Damage 1 
	+STRIFEDAMAGE 
	+RIPPER 
	PROJECTILE 
	+NODAMAGETHRUST
	ProjectileKickback 0
	//DONTHURTSHOOTER   
	RENDERSTYLE Translucent 
	ALPHA 0.67 
	States 
	{
		Spawn: 
			CLOD AABBCCBBAABBCCBBAABBCCBBAABBCCBBAABBCCDDCCBBAABBCCDDCCBBCCBBAABBCCDDEEFFGG 3
			{
				A_ScaleVelocity(0.9875);
			}
			CLOD A 0
			{
				if (random(1,3) <= 1) { return state("Spawn"); }
				return state("");
			}
			Stop 
		Death: 
			CLOD ABCDEFG 4 
			Stop 
	}
} 
actor HappyCloudPlayer : HappyCloud
{ 
	Tag "Happy Gas"
	Radius 32 
	Height 32 
	Speed 3 
	Damage (finaldamagedealt) // 1 
	+STRIFEDAMAGE 
	+RIPPER 
	PROJECTILE 
	+NODAMAGETHRUST
	ProjectileKickback 0
	//DONTHURTSHOOTER   
	RENDERSTYLE Translucent 
	ALPHA 0.67 
	States 
	{
		Spawn: 
			CLOD AABBCCBBAABBCCBBAABBCCBBAABBCCBBAABBCCDDCCBBAABBCCDDCCBBCCBBAABBCCDDEEFFGG 3 NoDelay
			{
				A_ScaleVelocity(0.9875);
				finaldamagedealt = 1 * random(1,8);
			}
			CLOD A 0
			{
				if (random(1,3) <= 1) { return state("Spawn"); }
				return state("");
			}
			Stop 
		Death: 
			CLOD ABCDEFG 4 
			Stop 
	}
} 

ACTOR BingoNew : EECreature replaces Bingo 4110
{ 
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Bingo"

	Health 400 
	Speed 5 
	Radius 18
	Height 56
	Mass 300
	Meleedamage 1 
	REACTIONTIME 8 
	PainChance 128
	Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Zap", 1.25
	Painchance "Zap", 160
	MONSTER
	DropItem GasRocketLauncher 255
	DropItem ClownSouls 64
	+FLOORCLIP +NOGRAVITY +FLOAT +PUSHABLE +NORADIUSDMG 
	+FloatBob +SPAWNFLOAT 
	scale 0.85
	SeeSound "CHEDSEE"
	PainSound "REVN3"
	DeathSound ""
	ActiveSound "CHEDLAF"
	Obituary "%o got blasted by a freaky clown head." 
	MissileHeight 12
	MissileType RevRocket

	dropitem GreenArmor 2
	dropitem BlueArmor 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	var int user_flametimer;

	States 
	{
		Spawn:
			CHED A 0 NoDelay 
			CHED A 10 A_FloatLook(8)
			goto Spawn+1
		See: 
			CHED A 0
			CHED A 0 A_StartSound("DRONE")
			CHED AAAAAAAA 2
			{
				A_FloatChaseCheck(2,4,6,8,0.4,0.4);
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				user_flametimer += 1;
				if (user_flametimer == 2) 
				{
					A_CustomMissile("RFlame", -8, 0, 0, 1);
					user_flametimer == 0;
				}
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Goto See
		Missile:   
			TNT1 A 0
			CHED A 0 A_Jump(104,9)
			CHED A 0 A_Jump(136,2) 
			CHED A 0 A_Jump(88,13)
			CHED A 4
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			CHED A 6 Bright 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(3); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(5); }
				A_FaceTarget;

				A_CustomComboAttack("RevRocket", 12, (1*random(1,8)), "imp/melee");
			}
			Goto See 
			CHED A 2 Bright
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				A_FaceTarget;
			}
			CHED A 2 Bright 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				A_FaceTarget;

				A_SpawnProjectile("RevRocket", 12, -4, 0, 1);
			}
			CHED A 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			Goto See 
			CHED A 2 Bright
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				A_FaceTarget;
			}
			CHED A 2 Bright 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				A_FaceTarget;

				A_SpawnProjectile("RevRocket", 12, -12, 60, 1);
			}
			CHED A 2 Bright
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				A_FaceTarget;
			}
			CHED A 2 Bright 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				A_FaceTarget;

				A_SpawnProjectile("RevRocket", 12, -4, 60, 1);
			}
			CHED A 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			Goto See 
			CHED A 4 Bright
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			CHED A 2 Bright 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				A_FaceTarget;

				A_SpawnProjectile("RevRocket", 12, 12, 0, 1);
			}
			CHED A 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			Goto See 
		Pain: 
			CHED A 4 A_FloatPain(0,4,64)  
			Goto See 
		Death:
			TNT1 A 0 
			CHED A 1 A_Scream 
			CHED B 6  A_NoBlocking 
			CHED CD 6
			CHED EFGHIJKL 4
			CHED M 4
			Stop 
		Ice:
			CHED A 5 A_GenericFreezeDeath
			CHED A 1 A_FreezeDeathChunks
			wait
	}
} 

ACTOR TinyBingoNew : EECreature replaces TinyBingo 4179
{ 
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Tiny Bingo"

	Health 35 
	Speed 6 
	Radius 9
	Height 24
	Mass 300
	Meleedamage 1 
	REACTIONTIME 8 
	PainChance 128
	Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Zap", 1.25
	Painchance "Zap", 160
	DamageFactor "Suck", 5.0
	PainChance "Suck", 256
	MONSTER
	DropItem ClownSouls 5
	+FLOORCLIP +NOGRAVITY +FLOAT +PUSHABLE 
	+FloatBob +SPAWNFLOAT 
	scale 0.35
	SeeSound "TINY2"
	PainSound "TINYPAIN"
	DeathSound "TINYDIE"
	ActiveSound "TINYACT"
	Obituary "%o got blasted by a freaky clown head." 
	MissileHeight 12
	MissileType MyBall

	dropitem GreenArmor 4
	dropitem BlueArmor 4
	dropitem HealthBonus 4
	dropitem ArmorBonus 4

	States 
	{
		Spawn:
			CHED A 0 NoDelay 
			CHED A 10 A_FloatLook(16) 
			goto Spawn+1
		See: 
			CHED A 0
			CHED A 2
			{
				A_FloatChaseCheck(4,8,12,16,0.6,0.6);
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Goto See
		Missile:   
			TNT1 A 0
			CHED A 4
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(3); }
				A_FaceTarget;
			}
			CHED A 2 Bright 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				A_FaceTarget;

				A_SpawnProjectile("TinyBingoBall", 12, -8, 0, 1);
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) 
				{
					A_SpawnProjectile("TinyBingoBall", 18, -12, 0, 1);
					A_SpawnProjectile("TinyBingoBall", 6, -4, 0, 1);
				}
			}
			CHED A 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(3); }
				A_FaceTarget;
			}
			Goto See 
		Pain: 
			CHED A 4 A_FloatPain(0,8,48)  
			Goto See 
		Death:
			TNT1 A 0 
			CHED A 1 A_Scream 
			CHED B 6 A_NoBlocking 
			CHED CD 6
			CHED EFGHIJKL 4
			CHED M 4     
			Stop    
		Ice:
			CHED A 5 A_GenericFreezeDeath
			CHED A 1 A_FreezeDeathChunks
			wait
	}
} 

//
actor BeefyBall1 : EEEffectProjectile
{
	Tag "Micro Deadlight"
	Radius 8
	Height 6
	Speed 10
	Damage (3 * random(1,8))
	DamageType "Deadlight"
	scale 0.8
	//+SEEKERMISSILE
	PROJECTILE
	ALPHA 0.8
	SeeSound "imp/attack"
	DeathSound "CBLAST1"
	+BOUNCEONWALLS
	+BOUNCEONFLOORS
	+BOUNCEONCEILINGS
	+NOBOUNCESOUND
	+DONTBOUNCEONSHOOTABLES
	+CANBOUNCEWATER
	+USEBOUNCESTATE
	+MTHRUSPECIES
	Species "Beefy"
	BounceType "Hexen"
	BounceFactor 1.0
	WallBounceFactor 1.0
	BounceCount 4

	States
	{
		Spawn:
			MBBB AABB 1 bright
			{
				A_ScaleVelocity(1.0000625);
			}
			Goto Spawn+2
		Bounce:
			TNT1 A 0 
			{
				A_StartSound("randomboing",CHAN_5,1.0,0,ATTN_NORM,0,frandom(0.75,1.25));
			}
			Goto Spawn
		Death:
			TNT1 A 0 Bright
			{
				A_StatusEffectChecker(4);
				if (random(1,user_ailmentmaxchance) <= 1 && user_canafflict)
				{
					user_random = random(1,13);
					//if (user_random == 1) { ACS_NamedExecuteAlways("BuffTimer",0,8,21,random(105,175)); } // Silence for 3-5 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 2) { ACS_NamedExecuteAlways("BuffTimer",0,8,19,random(105,175)); } // Blind for 3-5 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 3) { ACS_NamedExecuteAlways("BuffTimer",0,8,20,random(105,175)); } // Sleep for 3-5 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 4) { ACS_NamedExecuteAlways("BuffTimer",0,8,18,random(105,175)); } // Fatigue for 3-5 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 5) { ACS_NamedExecuteAlways("BuffTimer",0,8,14,random(210,350)); } // Sap for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 6) { ACS_NamedExecuteAlways("BuffTimer",0,8,14,random(210,350)); } // Sap for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 7) { ACS_NamedExecuteAlways("BuffTimer",0,8,14,random(210,350)); } // Sap for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 8) { ACS_NamedExecuteAlways("BuffTimer",0,8,13,random(210,350)); } // Blunt for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 9) { ACS_NamedExecuteAlways("BuffTimer",0,8,13,random(210,350)); } // Blunt for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 10) { ACS_NamedExecuteAlways("BuffTimer",0,8,13,random(210,350)); } // Blunt for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 11) { ACS_NamedExecuteAlways("BuffTimer",0,8,15,random(210,350)); } // Deceleratle for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 12) { ACS_NamedExecuteAlways("BuffTimer",0,8,15,random(210,350)); } // Deceleratle for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 13) { ACS_NamedExecuteAlways("BuffTimer",0,8,15,random(210,350)); } // Deceleratle for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
				}
			}
		Death2:
			MBBB C 4 Bright A_Scream
			MBBB DDDDDDDDDDDD 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
			MBBB D 4 Bright A_Fall
			MBBB E 4 Bright 
			MBBB EEEEEEEEEEEEE 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
			MBBB FFFFFFFFFF 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
			MBBB F 4 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
			MBBB G 4 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
			MBBB GGGGGGG 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
			MBBB H 4 
			MBBB I 4 
			Stop
	}
}
actor BeefyBall2 : BeefyBall1
{
	Tag "Seeking Micro Deadlight"
	Radius 8
	Height 6
	Speed 5
	Damage (4 * random(1,8))
	DamageType "Deadlight"
	scale 1.0
	+SEEKERMISSILE
	+USEBOUNCESTATE
	+MTHRUSPECIES
	Species "Beefy"
	PROJECTILE
	ALPHA 0.8
	SeeSound "imp/attack"
	DeathSound "EXPLODE"
	ExplosionRadius 48
	ExplosionDamage 20

	States
	{
		Spawn:
			MBBB AA 1 bright 
			{
				A_ScaleVelocity(1.0003125);
				A_EESeekerMissile(15,15);
			}
			MBBB BB 1 bright
			{
				if (user_noseektimer > 0) { user_noseektimer--; }
				A_ScaleVelocity(1.0003125);
				A_CustomMissile("RevTrail", 0, 0, 0, 1);
			}
			Loop
		Bounce:
			TNT1 A 0 
			{
				A_EESeekerBounce(18,3,false);
				A_StartSound("randomboing",CHAN_5,1.0,0,ATTN_NORM,0,frandom(0.75,1.25));
			}
			Goto Spawn
		Death:
			TNT1 A 0 Bright
			{
				A_StatusEffectChecker(4);
				if (random(1,user_ailmentmaxchance) <= 1 && user_canafflict)
				{
					user_random = random(1,12);
					//if (user_random == 1) { ACS_NamedExecuteAlways("BuffTimer",0,8,21,random(105,175)); } // Silence for 3-5 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 2) { ACS_NamedExecuteAlways("BuffTimer",0,8,19,random(105,175)); } // Blind for 3-5 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 3) { ACS_NamedExecuteAlways("BuffTimer",0,8,20,random(105,175)); } // Sleep for 3-5 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 4) { ACS_NamedExecuteAlways("BuffTimer",0,8,14,random(210,350)); } // Sap for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 5) { ACS_NamedExecuteAlways("BuffTimer",0,8,14,random(210,350)); } // Sap for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 6) { ACS_NamedExecuteAlways("BuffTimer",0,8,14,random(210,350)); } // Sap for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 7) { ACS_NamedExecuteAlways("BuffTimer",0,8,13,random(210,350)); } // Blunt for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 8) { ACS_NamedExecuteAlways("BuffTimer",0,8,13,random(210,350)); } // Blunt for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 9) { ACS_NamedExecuteAlways("BuffTimer",0,8,13,random(210,350)); } // Blunt for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 10) { ACS_NamedExecuteAlways("BuffTimer",0,8,15,random(210,350)); } // Deceleratle for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 11) { ACS_NamedExecuteAlways("BuffTimer",0,8,15,random(210,350)); } // Deceleratle for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
					//else if (user_random == 12) { ACS_NamedExecuteAlways("BuffTimer",0,8,15,random(210,350)); } // Deceleratle for 6-10 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
				}
			}
		Death2:
			GLOB A 0 Bright A_Explode(20,48,0,0,24)
			GLOB A 4 Bright A_Scream
			GLOB B 4 Bright A_Fall
			GLOB C 4 Bright 
			GLOB DEFGH 4
			Stop
	}
}
actor BeefyNew : EECreature replaces Beefy 4333
{
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Beefy The Clown"
	
	Health 120
	Radius 20
	Height 56
	Speed 8
	PainChance 200
	Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Deadlight", 3
	DamageFactor "Zap", 1.25
	Painchance "Deadlight", 255
	Painchance "Zap", 250
	DamageFactor "Cricket", 2.0
	PainChance "Cricket", 256
	MONSTER 
	DropItem ClownSouls 20
	+FLOORCLIP
	SeeSound "BEEFSEE"
	PainSound "GHS2PAN"
	DeathSound "GHS2PAN"
	ActiveSound "BEEFY"
	MeleeSound "imp/melee"
	Obituary "%o was killed by beefy the clown."
	HitObituary "%o was scratched by beefy the clown."
	MissileHeight 32
	MissileType BeefyBall1
	Species "Beefy"

	dropitem GreenArmor 2
	dropitem BlueArmor 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	States
	{
		Spawn:
			CIMP A 0 NoDelay 
			CIMP AB 10 A_Look
			goto Spawn+1
		See:
			CIMP A 0
			CIMP AABBCCDD 3
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(2); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Loop
		Melee:
			TNT1 A 0
			CIMP J 8 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(5); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(6); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(7); }

				A_FaceTarget;
			}
			CIMP K 6 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(3); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(5); }
				A_FaceTarget;

				A_CustomComboAttack("BeefyBall1", 32, 3*random(1,8), "imp/melee");
			}
			Goto See
		Missile:
			TNT1 A 0
			CIMP J 0 A_Jump(128,4)
			CIMP J 9 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(5); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(6); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(7); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(8); }

				A_FaceTarget;
			}
			CIMP K 9 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(5); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(6); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(7); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(8); }

				A_SpawnProjectile("BeefyBall1", 32, 0, 0);
			}
			Goto See
			CIMP JJ 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			CIMP K 6
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(3); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(5); }

				A_SpawnProjectile("BeefyBall1", 32, 0, 0);
			}
			CIMP J 8 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(5); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(6); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(7); }

				A_FaceTarget;
			}
			CIMP J 0 A_Jump(128,5)
			CIMP J 8 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(5); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(6); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(7); }

				A_FaceTarget;
			}
			CIMP K 6
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(3); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(5); }

				A_SpawnProjectile("BeefyBall2", 32, 0, 0);
			}
			CIMP J 8 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(5); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(6); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(7); }

				A_FaceTarget;
			}
			Goto See
			CIMP JJ 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			CIMP K 9
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(5); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(6); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(7); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(8); }

				A_SpawnProjectile("BeefyBall2", 32, 0, 0);
			}
			CIMP J 8 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(5); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(6); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(7); }

				A_FaceTarget;
			}
			Goto See
		Pain:
			CIMP L 2
			CIMP L 2 A_EEPain
			Goto See
		Pain.Deadlight:
			CIMP L 2
			CIMP L 2 A_EEPain
			CIMP LLLLLLLL 2
			{
				A_SetTics(randompick(1,2,2,2,2,3));
			}
			Goto See
		Death:
			TNT1 A 0 
			CIMP E 8 A_Scream
			CIMP F 4 A_CustomMissile("Gibb3", 20, -1, -60, 1)
			CIMP F 4 A_TossGib
			CIMP G 1 A_Fall
			CIMP G 1 A_TossGib
			CIMP G 1 A_CustomMissile("Gibb1", 16, -2, -30, 1)
			CIMP G 1 A_TossGib
			CIMP G 1 A_CustomMissile("BSplatter", 2,0,0, 1)
			CIMP G 1 A_TossGib
			CIMP G 1 A_CustomMissile("Gibb2", 14, 2, -10, 1)
			CIMP G 0 A_TossGib
			CIMP G 1 A_StartSound("splat11")
			CIMP G 1 A_CustomMissile("BSplatter", 14, 0, 0, 1)
			CIMP H 1 A_CustomMissile("Gibb4", 12, 3, 32, 1)
			CIMP H 1 A_TossGib
			CIMP H 1 A_CustomMissile("Gibb5", 10, 3, 0, 1)
			CIMP H 1 A_TossGib
			CIMP H 1 A_CustomMissile("BSplatter", 10, 1, 16, 1)
			CIMP H 1 A_CustomMissile("BeefyHead", -20, 0, 0)
			CIMP H 1 A_TossGib
			CIMP H 1 A_CustomMissile("BSplatter", 16, -1, -16, 1) 
			CIMP H 1 A_TossGib
			CIMP H 2 A_CustomMissile("Gibb3", 4, 3, 0, 1)
			CIMP I -1
			Stop
		XDeath:
			TNT1 A 0 
			CIMP E 4 A_Scream
			CIMP E 4 A_TossGib
			CIMP F 4 A_CustomMissile("Gibb3", 20, 0, -60, 1)
			CIMP F 4 A_TossGib
			CIMP F 1 A_Fall
			CIMP F 1 A_TossGib
			CIMP G 1 A_CustomMissile("Gibb1", 16, 0, -10, 1)
			CIMP G 0 A_TossGib
			CIMP G 1 A_CustomMissile("BSplatter", 38,0,0, 1)
			CIMP G 1 A_TossGib
			CIMP G 1 A_CustomMissile("Gibb2", 14, 0, -30, 1)
			CIMP G 1 A_TossGib
			CIMP G 1 A_StartSound("splat11")
			CIMP G 0 A_TossGib
			CIMP G 1 A_CustomMissile("BSplatter", 24, 0, 0, 1)
			CIMP H 1 A_TossGib
			CIMP H 1 A_CustomMissile("Gibb4", 12, 0, 32, 1)
			CIMP H 1 A_TossGib
			CIMP H 1 A_CustomMissile("Gibb5", 10, 0, 0, 1)
			CIMP H 0 A_TossGib
			CIMP H 1 A_CustomMissile("BSplatter", 24, 0, 16, 1)
			CIMP H 1 A_CustomMissile("BeefyHead", -20, 0, 0)
			CIMP H 1 A_TossGib
			CIMP H 1 A_CustomMissile("BSplatter", 16, 0, -16, 1) 
			CIMP H 1 A_TossGib
			CIMP H 3 A_CustomMissile("Gibb3", 4, 0, 0, 1)
			CIMP I -1
			Stop
		Ice:
			CIMP L 5 A_GenericFreezeDeath
			CIMP L 1 A_FreezeDeathChunks
			wait
	}
}

ACTOR BlackBearNew : EECreature replaces BlackBear 3191
{
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Tiny Black Bear"

	Health 16
	Radius 8
	Height 20
	Speed 9
	Mass 20
	PainChance 90
	Painchance "Fist", 135 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 225 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Zap", 1.25
	Painchance "Zap", 112
	DamageFactor "Beats", 5.0
	PainChance "Beats", 256
	MONSTER 
	+FLOORCLIP
	+NOCLIP
	+RANDOMIZE
	+COUNTKILL
	+CANPASS
	+DONTOVERLAP 
	Scale 0.75
	MELEEDAMAGE 1
	SeeSound ""
	PainSound ""
	DeathSound ""
	ActiveSound "BLACK"
	MeleeSound ""
	MeleeRange 24
	HitObituary "%o was exploded to bits by a tiny bear effigy."
	Obituary "%o was exploded to bits by a tiny bear effigy."
	ExplosionRadius 40
	ExplosionDamage 11

	dropitem HealthBonus 1
	dropitem ArmorBonus 1
	States
	{
		Spawn:
			BBER A 0 NoDelay 
			BBER AB 4 A_Look // if (IsPointerEqual(AAPTR_MASTER,AAPTR_DEFAULT) == 0) { Thing_Hate(tid,0,4); }
			goto Spawn+1
		See:
			BBER A 0
			BBER ABCD 2
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Loop
		Pain:
			BBER B 4 A_EEPain
			Goto See
		Melee:
		Death:
			BBER A 1 
			{
				A_FaceTarget;
				A_CustomMeleeAttack(3*random(1,4), "");
			}
			BBER A 1 A_Scream
			BBER A 1 A_Fall
			BBER A 1 A_Explode(11,48,XF_NOTMISSILE,true,24)
			BBER A 0 A_StartSound("splat11")
			BBER A 1 A_CustomMissile("BSplatter", 0, 0, 0, 1)
			BBER A 0 A_CustomMissile("BlackSplatter1", 6, 0, random(-180, 180), 2, random(0, 180))
			BBER AAA 0 A_CustomMissile("BlackSplatter2", 6, 0, random(-180, 180), 2, random(0, 180))		
			BBER A 1
			Stop
		Ice:
			BBER B 5 A_GenericFreezeDeath
			BBER B 1 A_FreezeDeathChunks
			wait
	}
}

//=========================================================================
actor SkullSeeker2 : SkullSeeker
{
	Tag "Skull Seeker"
	Damage (2 * random(1,8))
	SeeSound "GHSTATT"
	States
	{
		Spawn:
			GHST AB 4 A_SeekerMissile (5,20)
			Loop
		Death:
			GHST CDEFG 4 Bright
			Stop
	}
}
actor ClownGhostNew : EECreature replaces ClownGhost 32128
{ 
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Clown Ghost Balloon"
	EECreature.ActorFamily "Balloon"

	Health 300 
	Speed 5 
	Radius 16
	Height 48
	Mass 400
	Meleedamage 1 
	gibhealth -400
	REACTIONTIME 8 
	PainChance 128
	Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Zap", 1.5
	Painchance "Zap", 192
	DamageFactor "Suck", 0.25
	Painchance "Suck", 32
	MONSTER
	DropItem ClownSouls 75
	+FLOORCLIP +NOCLIP +NOGRAVITY +FLOAT +FloatBob +DONTHURTSPECIES +NOTARGET
	RENDERSTYLE Translucent
	ALPHA 0.67
	SeeSound ""
	PainSound "GHSTPAIN"
	DeathSound "GHSTDIE"
	ActiveSound "GIDLE"  
	MeleeSound "imp/melee"
	HitObituary "%o got bit by a clown ghost." 
	Obituary "%o got killed by a clown ghost." 
	MissileHeight 12
	MissileType SkullSeeker2 

	dropitem GreenArmor 2
	dropitem BlueArmor 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	States 
	{
		Spawn:
			GHOS C 0 NoDelay 
			GHOS C 10 A_FloatLook(12)
			goto Spawn+1
		See: 
			GHOS D 0
			GHOS DEF 10
			{
				A_FloatChaseCheck(3,6,9,12,0.5,0.5);
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(6); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(7); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(8); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 30) { A_SetTics(9); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			GHOS A 0 A_Jump(128,5)
			GHOS AAAA 4
			{
				A_FloatChaseCheck(3,6,9,12,0.5,0.5);
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(3); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Goto See+4
			TNT1 A 0
			GHOS BBBBBBBBBBBBBBB 1 Bright
			{
				A_FloatChaseCheck(3,6,9,12,0.5,0.5);
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Goto See+4
		Melee:
			TNT1 A 0
			GHOS A 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			GHOS F 3  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			GHOS G 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
				
				A_CustomMeleeAttack(3*random(1,10), "imp/melee");
			}
			GHOS F 3  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			Goto See+4
		Missile: 
			TNT1 A 0
			GHOS F 0 A_Jump(245,3)
			GHOS F 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			GHOS G 6 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(3); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(5); }
				A_FaceTarget;

				A_CustomComboAttack("SkullSeeker2", 32, 3*random(1,8), "imp/melee");
			}
			GHOS FGGGGGGF 1
			{
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Goto See+4
		Pain: 
			GHOS A 4 A_FloatPain(0,6,64) 
			Goto See+4
		Death:
			TNT1 A 0 
			GHOS B 1 A_Scream 
			GHOS F 8 A_NoBlocking 
			GHOS E 8 //A_CustomMissile("ClownSoulFloat1", 8, random(-15, 15), random(-180, 180), 2, random(80, 100))
			GHOS D 8 A_StartSound("BOONBITE")
			GHOS C 0 A_CustomMissile("Balloon_Black", 8, 0, 0, 1)
			Stop 
		Ice:
			GHOS A 5 A_GenericFreezeDeath
			GHOS A 1 A_FreezeDeathChunks
			wait
	}
}

//
actor Ghost2Ball : EEProjectile
{
	Tag "Clown Ghost Fireball"
	Radius 8
	Height 6
	Speed 10
	Damage (5*random(1,8))
	scale 1
	//+SEEKERMISSILE 
	PROJECTILE
	ALPHA 0.8
	SeeSound "BULBEXP2"
	DeathSound "imp/shotx"
	DamageType "Fire"
	States
	{
		Spawn:
			GHBL A 2 bright
			Goto Spawn
		Death:
			GHBL B 0 Bright A_Scream
			GHBL B 0 Bright A_Fall
			GHBL B 4 Bright A_CustomMissile("HellFire", 0, 0, 0, CMF_TRACKOWNER)
			GHBL B 0 Bright A_CustomMissile("Sparkles", 8, 0, random(-180, 180), CMF_AIMOFFSET|CMF_TRACKOWNER, random(-180, 180))
			GHBL B 0 Bright A_CustomMissile("Sparkles", 8, 0, random(-180, 180), CMF_AIMOFFSET|CMF_TRACKOWNER, random(-180, 180))
			GHBL B 0 Bright A_CustomMissile("Sparkles", 8, 0, random(-180, 180), CMF_AIMOFFSET|CMF_TRACKOWNER, random(-180, 180))
			GHBL B 0 Bright A_CustomMissile("Sparkles", 8, 0, random(-180, 180), CMF_AIMOFFSET|CMF_TRACKOWNER, random(-180, 180))
			GHBL B 0 Bright A_CustomMissile("Sparkles", 8, 0, random(-180, 180), CMF_AIMOFFSET|CMF_TRACKOWNER, random(-180, 180))
			GHBL B 0 Bright A_CustomMissile("Sparkles", 8, 0, random(-180, 180), CMF_AIMOFFSET|CMF_TRACKOWNER, random(-180, 180))
			GHBL C 2 Bright A_CustomMissile("HellFire", 0, -32, -300, CMF_TRACKOWNER)
			GHBL CCCCCCCCCCC 0 Bright A_CustomMissile("Sparkles", 8, 0, random(-180, 180), CMF_AIMOFFSET|CMF_TRACKOWNER, random(-180, 180))
			GHBL C 2 Bright A_CustomMissile("HellFire", 0, 32, -120, CMF_TRACKOWNER)
			GHBL CCCCCCCCCCC 0 Bright A_CustomMissile("Sparkles", 8, 0, random(-180, 180), CMF_AIMOFFSET|CMF_TRACKOWNER, random(-180, 180))
			GHBL D 4 Bright 
			GHBL DDDDDDDDDD 0 Bright A_CustomMissile("Sparkles", 8, 0, random(-180, 180), CMF_AIMOFFSET|CMF_TRACKOWNER, random(-180, 180))
			GHBL EEEEE 0 Bright A_CustomMissile("Sparkles", 8, 0, random(-180, 180), CMF_AIMOFFSET|CMF_TRACKOWNER, random(-180, 180))
			GHBL E 4 Bright 
			Stop      
	}
}

actor ClownGhost2New : EECreature replaces ClownGhost2 31211
{ 
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Ghost Clown Face"

	Health 150
	Speed 6 
	Radius 16
	Height 48
	Mass 400
	Meleedamage 3 
	REACTIONTIME 8 
	PainChance 128
	Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Ice", 2
	DamageFactor "Zap", 1.5
	Painchance "Ice", 255
	Painchance "Zap", 192
	DamageFactor "Suck", 2.5
	Painchance "Suck", 256
	MONSTER
	DropItem ClownSouls 100
	+FLOORCLIP +NOCLIP +NOGRAVITY +FLOAT +FloatBob +NORADIUSDMG +NOTARGET
	RENDERSTYLE Translucent
	ALPHA 0.67
	SeeSound ""
	PainSound "GHS2PAN"
	DeathSound "GHS2PAN"
	ActiveSound "GHS2ACT"
	MeleeSound "imp/melee"
	HitObituary "%o got ripped up by a flaming clown ghost." 
	Obituary "%o got incinerated by a flaming clown ghost." 
	MissileHeight 15
	MissileType Ghost2Ball

	dropitem GreenArmor 2
	dropitem BlueArmor 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	States 
	{
		Spawn:
			GST2 A 0 NoDelay 
			GST2 AB 10 A_FloatLook(12)
			goto Spawn+1
		See: 
			GST2 A 0
			GST2 A 1 A_JumpIfCloser(1500,5)
			GST2 AABB 1
			{
				A_FloatChaseCheck(3,6,9,12,0.5,0.5);
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Loop
			GST2 A 0
			GST2 A 0 
			{
				A_SpawnProjectile("HellFire2", 0, 0, 0);
			}
			GST2 AABB 1
			{
				A_FloatChaseCheck(3,6,9,12,0.5,0.5);
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Goto See
		Melee:
			TNT1 A 0
			GST2 A 4  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			GST2 B 3  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			GST2 C 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
				
				A_CustomMeleeAttack(3*random(1,10), "imp/melee");
			}
			GST2 B 3  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			Goto See
		Missile:
			TNT1 A 0
			GST2 B 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			GST2 C 6 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(3); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(5); }
				A_FaceTarget;

				A_CustomComboAttack("Ghost2Ball", 32, 3*random(1,8), "imp/melee");
			}
			GST2 B 4  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(3); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Goto See
		Pain: 
			GST2 B 4 A_FloatPain(0,6,64) 
			Goto See
		Pain.Ice: 
			GST2 B 4 A_FloatPain(0,6,64) 
			GST2 BBBBBB 4
			Goto See
		Death:
			TNT1 A 0 
			GST2 D 1 A_Scream 
			GST2 D 2 A_TossGib
			GST2 E 2 A_CustomMissile("BSplatter", 16, 0,0, 1)
			GST2 E 2 A_TossGib
			GST2 F 2 A_NoBlocking 
			GST2 F 2 A_TossGib
			GST2 G 2 A_CustomMissile("HellFire1", 8, 0, -180)
			GST2 G 2 A_TossGib
			GST2 H 2 A_TossGib
			GST2 H 2 A_TossGib
			Stop   
		Ice:
			GST2 B 5 A_GenericFreezeDeath
			GST2 B 1 A_FreezeDeathChunks
			wait
	}
}

//

//
actor BulbyBall : EEProjectile
{
	Tag "Small Bulby Blast"
	Radius 8
	Height 6
	Speed 10
	Damage (2 * random(1,8))
	DamageType "Electric"
	//+SEEKERMISSILE
	PROJECTILE
	scale 1.0
	ALPHA 0.8
	SeeSound ""
	DeathSound "BULBEXP"
	ExplosionRadius 48
	ExplosionDamage 16
	States
	{
		Spawn:
			BBBL AABBCCBB 2 bright
			{
				A_ScaleVelocity(1.0025);
				A_CustomMissile("bsmoke", 6, 0, 0, 0);
			}
			Loop
		Death:
			BBBL D 1 Bright A_Fall
			BBBL D 4 Bright A_Explode(16,48)
			BBBL E 4 Bright A_Scream
			BBBL FG 4 Bright 
			Stop
	}
}

actor BulbyBall2 : EEProjectile
{
	Tag "Large Bulby Blast"
	Radius 8
	Height 6
	Speed 10
	Damage (3 * random(1,8))
	DamageType "Electric"
	+SEEKERMISSILE 
	PROJECTILE
	scale 0.9
	ALPHA 0.8
	DeathSound "BULBEXP"
	ExplosionRadius 64
	ExplosionDamage 24
	States
	{
		Spawn:
			BBBL A 0 A_SeekerMissile(10,10)
			BBBL AABB 2 bright
			{
				A_ScaleVelocity(1.0025);
				A_CustomMissile("bsmoke", 6, 0, 0, 1);
			}
			BBBL C 0 A_SeekerMissile(10,10)
			BBBL CCBB 2 bright
			{
				A_ScaleVelocity(1.0025);
				A_CustomMissile("bsmoke", 6, 0, 0, 1);
			}
			Loop
		Death:
			BBBL D 1 Bright A_Fall
			BBBL D 4 Bright A_Explode(24,64)
			BBBL E 4 Bright A_Scream
			BBBL FG 4 Bright 
			Stop
	}
}

actor BulbyBall3 : EEProjectile
{
	Tag "Large Bulby Blast"
	Radius 16
	Height 16
	Speed 12
	Damage (3 * random(1,8))
	DamageType "Electric"
	+SEEKERMISSILE
	PROJECTILE
	scale 1.4
	ALPHA 0.8
	SeeSound "GHSTATT"
	DeathSound "BULBEXP"
	ExplosionRadius 96
	ExplosionDamage 32
	States
	{
		Spawn:
			BBBL A 0 A_SeekerMissile(20,20)
			BBBL AABB 2 bright
			{
				A_ScaleVelocity(1.0025);
				A_CustomMissile("bsmoke", 6, 0, 0, 1);
			}
			BBBL C 0 A_SeekerMissile(20,20)
			BBBL CCBB 2 bright
			{
				A_ScaleVelocity(1.0025);
				A_CustomMissile("bsmoke", 6, 0, 0, 1);
			}
			Loop
		Death:
			BBBL D 1 Bright A_Fall
			BBBL D 4 Bright A_Explode(32,96)
			BBBL E 4 Bright A_Scream
			BBBL FG 4 Bright 
			Stop
	}
}

actor BulbyNew : EECreature replaces Bulby 3906
{ 
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Bulby"

	Health 200 
	Speed 5 
	Radius 16
	Height 32
	Mass 400
	Meleedamage 1 
	Scale 0.7
	DamageFactor "Zap", 1.25
	Painchance "Zap", 160
	DamageFactor "Breakfast", 5.0
	Painchance "Zap", 255
	PainChance 128
	Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	MONSTER
	DropItem ClownSouls 6
	+FLOORCLIP +FLOAT +NOTARGET //+NORADIUSDMG 
	SeeSound "BOTTLE2"
	PainSound "GHS2PAIN"
	DeathSound "BOTTLE2"
	ActiveSound "BULBSEE"  
	MeleeSound "imp/melee"
	HitObituary "%o got electroshocked by Bulby." 
	Obituary "%o got killed by Bulby." 
	MissileType BulbyBall

	dropitem GreenArmor 2
	dropitem BlueArmor 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	States 
	{
		Spawn:
			LDEM A 0 NoDelay 
			LDEM A 2 A_UnSetShootable
			LDEM A 2 A_FloatLook(16)
			goto Spawn+1
		See: 
			LLLL A 0
			LLLL A 16 A_UnSetShootable
			LLLL B 7
			LLLL C 7
			LDEM A 6 
			LDEM B 6 
			LDEM C 5
			LDEM D 5 
			LDEM E 4
			LDEM F 2 A_NoGravity 
			LDEM F 2 A_SetShootable
		See2:
			LLLL A 0
			LDEM G 2
			{
				A_FloatChaseCheck(4,8,12,16,0.5,0.5);
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			loop
		Melee: 
			TNT1 A 0
			LDEM GH 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			LDEM I 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
				
				A_CustomMeleeAttack((3*random(1,10)), "imp/melee");
			}
			LDEM H 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			Goto See2
		Missile:  
			TNT1 A 0
			LDEM G 0 A_Jump(88,"Missile2")
			LDEM GH 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			LDEM I 2 Bright 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				A_FaceTarget;

				A_StartSound("BULBEXP2");
				A_SpawnProjectile("BulbyBall", 12, -4, 0, 1);
			}
			LDEM H 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			Goto See2
		Missile2:  
			LDEM GH 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			LDEM I 4 Bright 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }

				A_StartSound("BULBEXP2");
				A_SpawnProjectile("BulbyBall2", 12, -4, 0, 1);
			}
			LDEM H 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			Goto See2
		Pain: 
			LDEM J 4 A_FloatPain(0,8,64) 
			Goto See2
		Death:
			TNT1 A 0 
			LDEM J 1 A_Scream 
			LDEM K 1 A_TossGib
			LDEM K 1 A_CustomMissile("BSplatter", 0, 0, 0, 1) 
			LDEM K 1 A_TossGib
			LDEM K 2 A_StartSound("splat11")
			LDEM K 2 A_CustomMissile("BulbyGib1", 24, 16, 60, 1)
			LDEM K 2 A_TossGib
			LDEM L 2 A_CustomMissile("BSplatter", 40, -16, -32, 1)
			LDEM L 2 A_TossGib
			LDEM L 2 A_CustomMissile("BulbyGib2", 16, 8, -30, 1)
			LDEM L 2 A_TossGib
			LDEM M 4 A_NoBlocking 
			LDEM M 2 A_CustomMissile("BulbyGib3", 32, -16, -60, 1)
			LDEM M 2 A_TossGib
			LDEM N 2 A_CustomMissile("BSplatter", 24, 30, 32, 1)
			LDEM N 2 A_TossGib
			LDEM N 2 A_CustomMissile("BSplatter", 20, 32, 0, 1)
			LDEM N 2 A_TossGib
			LDEM N -1
			Stop   
		Ice:
			LDEM J 5 A_GenericFreezeDeath
			LDEM J 1 A_FreezeDeathChunks
			wait
	}
}

actor MegaBulbyNew : EECreature replaces MegaBulby 3989
{ 
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Mega Bulby"

	Health 400 
	Speed 6 
	Radius 32
	Height 64
	Mass 400
	Meleedamage 1 
	Scale 1.5
	PainChance 64
	Painchance "Fist", 96 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 160 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Zap", 1.25
	Painchance "Zap", 80
	MONSTER
	DropItem ClownSouls 40
	+FLOORCLIP +FLOAT +NORADIUSDMG +NOGRAVITY +FloatBob +NOTARGET
	SeeSound "GHSTPAIN"
	PainSound "GHSTPAIN"
	DeathSound "GHSTPAIN"
	ActiveSound "GHSTATT"
	MeleeSound "imp/melee"
	HitObituary "%o got electroshocked by Mega Bulby." 
	Obituary "%o got killed by Mega Bulby." 
	MissileType BulbyBall3

	dropitem GreenArmor 2
	dropitem GreenArmor 2
	dropitem BlueArmor 2
	dropitem BlueArmor 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	States 
	{
		Spawn:
			LDEM G 0 NoDelay 
			LDEM G 2 A_FloatLook(8)
			goto Spawn+1
		See: 
			LDEM G 0
			LDEM G 2
			{
				A_FloatChaseCheck(2,4,6,8,0.334,0.334);
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			goto See+1
		Melee: 
			TNT1 A 0
			LDEM GH 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			LDEM I 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
				
				A_CustomMeleeAttack((7*random(1,10)), "imp/melee");
			}
			LDEM H 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			Goto See
		Missile:  
			TNT1 A 0
			LDEM G 0 A_Jump(5,"Missile2")
			LDEM GH 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			LDEM I 2 Bright 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				A_FaceTarget;

				A_StartSound("BULBEXP2");
				A_SpawnProjectile("BulbyBall3", 24, -4, 0, 1);
			}
			LDEM H 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			Goto See
		Missile2:  
			LDEM GH 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			LDEM I 4 Bright 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }

				A_SpawnProjectile("BulbyBall3", 24, -4, 0, 1);
			}
			LDEM H 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			Goto See
		Pain: 
			LDEM J 4 A_FloatPain(0,4,96) 
			Goto See
		Death:
			TNT1 A 0 
			LDEM J 1 A_Scream 
			LDEM K 1 A_CustomMissile("BSplatter", 0, 0, 0, 1) 
			LDEM K 1 A_TossGib
			LDEM K 1 A_StartSound("GHSTPAIN")
			LDEM K 1 A_TossGib
			LDEM K 2 A_CustomMissile("BulbyGib1", 24, 20, 60, 1)
			LDEM K 2 A_TossGib
			LDEM L 2 A_CustomMissile("BSplatter", 40, -18, -32, 1)
			LDEM L 2 A_TossGib
			LDEM L 1 A_CustomMissile("BulbyGib2", 16, 8, -30, 1)
			LDEM L 2 A_TossGib
			LDEM L 1 A_CustomMissile("BulbyGib3", 32, -32, -30, 1)
			LDEM L 2 A_TossGib
			LDEM M 2 A_NoBlocking 
			LDEM M 2 A_TossGib
			LDEM M 1 A_CustomMissile("BulbyGib3", 32, -16, -60, 1)
			LDEM M 1 A_TossGib
			LDEM M 1 A_CustomMissile("BulbyGib3", 32, -16, -60, 1)
			LDEM M 1 A_TossGib
			LDEM N 2 A_CustomMissile("BSplatter", 24, 30, 32, 1)
			LDEM N 2 A_TossGib
			LDEM N 1 A_CustomMissile("BSplatter", 20, 32, 0, 1)
			LDEM N 1 A_TossGib
			LDEM N 1 A_CustomMissile("BSplatter", 15, -16, 0, 1)
			LDEM N 1 A_TossGib
			LDEM N 2 A_IceGuyDie 
			Stop   
		Ice:
			LDEM J 5 A_GenericFreezeDeath
			LDEM J 1 A_FreezeDeathChunks
			wait
	}
}

//
actor BerthaBall : EEProjectile
{
	Tag "Bertha Blast"
	Damage (5 * random(1,8))
	Radius 8
	Height 6
	Speed 15
	scale 1
	//+SEEKERMISSILE
	PROJECTILE
	//ALPHA 0.8
	SeeSound ""
	DeathSound "BIRFIRE"
	States
	{
		Spawn:
			BRTF AB 0 A_SeekerMissile (10,10)  
			BRTF AB 2 bright A_CStaffMissileSlither 
			Loop
		Death:
			BRTF CCC 0 A_CustomMissile("BlackSplatter2", 6, 0, random(-180, 180), 2, random(0, 180))
			BRTF C 4 Bright A_Scream
			BRTF D 4 Bright A_Fall
			BRTF E 4 Bright 
			Stop
	}
}

ACTOR BigBertha2New : EECreature replaces BigBertha2 3192
{ 
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Big Bertha"
	EECreature.ActorFamily "Balloon"

	Health 675 
	Speed 6 
	Radius 24
	Height 92
	Mass 500
	Meleedamage 1 
	REACTIONTIME 8 
	PainChance 128
	Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Zap", 1.5
	Painchance "Zap", 192
	DamageFactor "Suck", 0.0125
	PainChance "Suck", 1
	MONSTER
	+FLOORCLIP +NOGRAVITY +FLOAT
	scale 1.25
	SeeSound "BIRTHA3"
	PainSound "BIRTHA1"
	DeathSound "BIRTHA1"
	ActiveSound "BIRTHA2"
	Obituary "%o touched big birtha's puke." 
	MissileHeight 12
	MissileType BlackBear
	dropitem GreenArmor 2
	dropitem GreenArmor 2
	dropitem BlueArmor 2
	dropitem BlueArmor 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem HealthBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	dropitem ArmorBonus 2
	States 
	{
		Spawn:
			BRTH A 0 NoDelay 
			BRTH A 10 A_FloatLook(8) 
			goto Spawn+1
		See: 
			BRTH A 0
			BRTH AAB 4
			{
				A_FloatChaseCheck(2,4,6,8,0.67,0.67);
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(3); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Goto See
		Missile: 
			TNT1 A 0
			BRTH A 0 A_Jump(128,"Missile2")  
			BRTH AABCDHEF 4
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			BRTH G 3
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }

				A_CustomMissile("BlackBlob", 12, 12, 0, 1);
				A_CustomMissile("BlackBlob", 12, 0, 0, 1);
				A_CustomMissile("BlackBlob", 12, -12, 0, 1);
			}
			BRTH DC 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			Goto See 
		Missile2: 
			BRTH ABC 4
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			BRTH D 2 Bright
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				A_FaceTarget;
				
				A_SpawnProjectile("BerthaBall", 48, 0, 0, 1);
			}
			BRTH C 4  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			Goto See 
		Pain: 
			BRTH A 4 
			{
				if (random(1,5) == 1) { A_CustomMissile("BlackBlob", 12, 6*random(-3,3), 0, 1); }
				if (random(1,5) == 1) { A_CustomMissile("BlackBlob", 12, 6*random(-3,3), 0, 1); }
				if (random(1,5) == 1) { A_CustomMissile("BlackBlob", 12, 6*random(-3,3), 0, 1); }
				if (random(1,5) == 1) { A_CustomMissile("BlackBlob", 12, 6*random(-3,3), 0, 1); }
				A_FloatPain(0,4,64);
			}
			Goto See 
		Death:
			TNT1 A 0 
			BRTH I 7 A_Scream 
			BRTH J 6 A_NoBlocking 
			BRTH K 6
			BRTH L 4
			BRTH MN 4
			BRTH O 4     
			{
				A_CustomMissile("BlackBlob", 12, 0, 0, 1);
				A_CustomMissile("BlackBlob", 12, 12, 0, 1); 
				A_CustomMissile("BlackBlob", 12, -13, 0, 1); 
				A_CustomMissile("BlackBlob", 12, -16, 0, 1);
				A_CustomMissile("BlackBlob", 12, 18, 0, 1);
				if (random(1,2) == 1)
				{
					A_CustomMissile("BlackBlob", 12, -12, 0, 1); 
					A_CustomMissile("BlackBlob", 12, 13, 0, 1); 
					A_CustomMissile("BlackBlob", 12, 16, 0, 1);
					A_CustomMissile("BlackBlob", 12, -18, 0, 1);
				}
			}
			Stop
		Ice:
			BRTH A 5 A_GenericFreezeDeath
			BRTH A 1 A_FreezeDeathChunks
			wait
	}
}

//
ACTOR SoulAttack : EEProjectile
{   
	Tag "Bertha Soul Strike"
	Damage (5 * random(1,8))
	renderstyle add
	Radius 6
	Height 10
	Speed 12
	+Missile
	+lowgravity
	+NoBlockmap
	+NoTeleport
	+NODAMAGETHRUST
	RENDERSTYLE Translucent
	ALPHA 0.5
	SCALE 0.6
	States
	{
		Spawn:
			SEEK AAAAAAAAAAAAAAAAAAAAAA 2 Bright
			{
				A_ScaleVelocity(1.01);
			}
			GLOB B 1 Bright 
			{
				A_ScaleVelocity(1.01);
			}
			GLOB A 3 Bright 
			{
				A_ScaleVelocity(1.01);
				A_Scream;
			}
			GLOB H 3 Bright 
			{
				A_ScaleVelocity(1.01);
				A_Fall;
			}
			Stop
		Death:
			GLOB B 1 Bright 
			{
				A_ScaleVelocity(1.01);
			}
			GLOB A 3 Bright 
			{
				A_ScaleVelocity(1.01);
				A_Scream;
			}
			GLOB H 3 Bright 
			{
				A_ScaleVelocity(1.01);
				A_Fall;
			}
			Stop
	}
} 

actor SuperBerthaNew : EECreature replaces SuperBertha 14768
{ 
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Super Bertha"
	EECreature.ActorFamily "Balloon"
	
	Health 6000 
	Speed 7 
	Radius 50
	Height 144
	Mass 40000
	Meleedamage 1 
	REACTIONTIME 8 
	MONSTER
	+FLOORCLIP
	+NOGRAVITY
	+FLOAT 
	+FloatBob
	SeeSound ""
	PainSound "GHSTPAIN"
	DeathSound "GHSTDIE"
	ActiveSound "BCLICK5"
	MeleeSound "imp/melee"
	Obituary "%o got launched into the stratosphere by Super Bertha." 
	Scale 1.25
	PainChance 128
	Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Zap", 192
	DamageFactor "Suck", 0.0125
	PainChance "Suck", 1

	DamageFactor 0.33
	RadiusDamageFactor 0.33
	DamageFactor "Explosive", 0.33

	DamageFactor "Zap", 1.5
	dropitem GreenArmor 8
	dropitem GreenArmor 8
	dropitem GreenArmor 8
	dropitem GreenArmor 8
	dropitem BlueArmor 8
	dropitem BlueArmor 8
	dropitem BlueArmor 8
	dropitem BlueArmor 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	States
	{
		Spawn:
			BRTH A 0 NoDelay 
			BBTH A 2 A_FloatLook(4) // A_SetInvulnerable
			goto Spawn+1
		See:
			BRTH A 0
			BBTH AA 2
			{
				A_FloatChaseCheck(1,2,3,4,0.5,0.5);
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Loop
		Missile:   
			TNT1 A 0
			BBTH A 0 A_JumpIfCloser(400,"Missile2")
			BBTH A 0 
			Goto See
		Missile2:   
			BBTH B 1
			{
				A_FaceTarget;
			}
			BBTH BBB 1 
			{
				A_SpawnProjectile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20));
				A_FaceTarget;
			}
			BBTH B 1 
			{
				A_SpawnProjectile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20));
				A_SpawnProjectile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20));
				A_FaceTarget;
			}
			BBTH BB 1 
			{
				A_SpawnProjectile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20));
				A_FaceTarget;
			}
			BBTH B 1 
			{
				A_SpawnProjectile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20));
				A_SpawnProjectile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20));
				A_FaceTarget;
			}
			BBTH BBB 1 
			{
				A_SpawnProjectile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20));
				A_FaceTarget;
			}
			Goto See
		Melee:
			TNT1 A 0
			BBTH BA 1 
			{
				A_FaceTarget;
			}
			BBTH C 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
				
				A_CustomMeleeAttack(1*random(1,10), "imp/melee");
			}
			BBTH AB 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			Goto See
		Pain:
			BBTH C 3 A_FloatPain(0,2,128)
			BBTH C 0
			{
				if (random(1,256) <= 192) { return state("Missile2"); }
				return state("");
			}
			Goto See
		Death:
			BBTH B 3 A_Scream
			BBTH B 3 
			BBTH B 2 A_CustomMissile("BSplatter", 64, -16, -32, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 32, -32, 0, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 16, 32, 32, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 128, -48, 64, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 144, 48, -16, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 40, 0, 0, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 112, 64, 16, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 64, 128, 72, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 8, 96, -104, 1)
			BBTH C 2 A_CustomMissile("BSplatter", 144, 144, 0, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 64, -16, -32, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 32, -32, 0, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 16, 32, 32, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 128, -48, 64, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 144, 48, -16, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 40, 0, 0, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 112, 64, 16, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 64, 128, 72, 1)
			BBTH B 2 A_CustomMissile("BSplatter", 8, 96, -104, 1)
			BBTH C 2 A_CustomMissile("BSplatter", 144, 144, 0, 1)
			SPL2 ABCDE 4 A_Fall
			Stop
		Ice:
			BBTH C 5 A_GenericFreezeDeath
			BBTH C 1 A_FreezeDeathChunks
			wait
	}
}

ACTOR EvilDeadHandNew : EECreature replaces EvilDeadHand 32212
{
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Evil Dead Hand"

	Health 20
	Radius 8
	Height 16
	Speed 5
	Mass 20
	PainChance 200
	Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Zap", 1.25
	Painchance "Zap", 250
	MONSTER 
	+FLOORCLIP +RANDOMIZE 
	scale 0.75
	MELEEDAMAGE 1
	SeeSound "HSEE"
	PainSound "HAND1"
	DeathSound "HAND3"
	ActiveSound "HAND1"
	MeleeSound "SKULBITE"
	HitObituary "%o was choked to death by the Evil Dead hand." 
	Obituary "%o was choked to death by the Evil Dead hand." 

	dropitem GreenArmor 1
	dropitem BlueArmor 1
	dropitem HealthBonus 1
	dropitem HealthBonus 1
	dropitem ArmorBonus 1
	dropitem ArmorBonus 1
	States
	{
		Spawn:
			HAND A 0 NoDelay 
			HAND A 4 A_Look
			goto Spawn+1
		See:
			HAND A 0
			HAND A 0 A_Jump(200,5)
			HAND A 0 A_CustomMissile("ZGut2", 0, 0, 180)  
			HAND A 0 A_Jump(250,2)
			HAND A 0 A_CustomMissile("ZGut3", 0, 0, 0)     
			HAND ABCB 2
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_ChangeFlag("AVOIDMELEE",1); }
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Loop
		Melee:
			TNT1 A 0
			HAND C 6 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(3); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(5); }
				A_FaceTarget;
			}
			HAND A 6 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(3); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(5); }
				A_FaceTarget;
				
				A_CustomMeleeAttack(1*random(1,10), "SKULBITE");
			}
			HAND B 6
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(3); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(5); }
				A_FaceTarget;
			}
			Goto See 
		Pain:
			HAND B 8 A_EEPain 
			Goto See 
		Death:
			HAND D 5 A_CustomMissile("ZGut2", 0, 0, 30) 
			HAND E 2 A_StartSound("splat11")
			HAND E 3 A_Scream 
			HAND F 0 A_CustomMissile("BSplatter", 0, 0, 0, 1)
			HAND F 5 A_CustomMissile("ZGut3", 0, 0, -40)   
			HAND G 5 A_Fall 
			HAND H -1 
			Stop 
		Ice:
			HAND B 5 A_GenericFreezeDeath
			HAND B 1 A_FreezeDeathChunks
			wait
	}
}

ACTOR BouncingClownNew : EECreature replaces BouncingClown 4822
{
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Giant Bouncing Clown"

	Health 6000
	Radius 24
	Height 112
	Speed 16
	Mass 2000
	MONSTER 
	+FLOORCLIP +RANDOMIZE +COUNTKILL +CANPASS
	+LOOKALLAROUND
	MELEEDAMAGE 3
	SeeSound "GAURD11"
	PainSound "GAURD12"
	DeathSound "GAURD12"
	ActiveSound "GAURD11"
	MeleeSound "BCHOMP"
	HitObituary "%o was eaten by a bouncing popcorn clown."
	Obituary "%o was killed by a bouncing popcorn clown."
	PainChance 25
	Painchance "Fist", 38 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 63 // Kick attacks have a +150% chance of stunning an enemy
	PainChance "Zap", 128
	PainChance "Melee", 128
	PainChance "Fire", 6
	DamageFactor "Zap", 0.75 // Magic does damage, but not quite a full amount
	DamageFactor "Melee", 1.25
	DamageFactor "Stomp", 1.25
	DamageFactor "Trample", 1.25
	DamageFactor "Fire", 0.25

	DamageFactor 0.125 // Most other damage doesn't work well [1/8th normal damage]
	RadiusDamageFactor 0.125
	DamageFactor "Explosive", 0.125
	dropitem GreenArmor 8
	dropitem GreenArmor 8
	dropitem GreenArmor 8
	dropitem GreenArmor 8
	dropitem GreenArmor 8
	dropitem BlueArmor 8
	dropitem BlueArmor 8
	dropitem BlueArmor 8
	dropitem BlueArmor 8
	dropitem BlueArmor 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	States
	{
		Spawn:
			BCWN A 0 NoDelay 
			BCWN AB 4 A_Look
			goto Spawn+1
		See:
			BCWN A 0
			BCWN A 2
			BCWN A 2
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			BCWN B 2
			BCWN B 2
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			BCWN CC 2
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			BCWN B 4
			BCWN A 0 A_JumpIfCloser(1024,1)
			Loop
			BCWN A 0
			BCWN A 0 A_StartSound("GAURD13")
			BCWN A 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN A 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN A 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN A 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN A 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN A 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN A 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN A 0
			Loop
		Melee:
			TNT1 A 0
			BCWN AB 3
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			BCWN C 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
				
				A_CustomMeleeAttack(10*random(1,10), "BCHOMP");
			}
			BCWN B 3  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			Goto See
		Pain:
			BCWN D 5 A_EEPain
			goto PainRetreat
		PainRetreat:
			BCWN E 0 A_SetInvulnerable
			BCWN E 5
			BCWN FFFF 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN GGGG 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN HHHH 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN IIII 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN JJJJ 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN JJJJJ 10
			{
				if (random(1,4) == 1) { A_SetTics(2); }
			}
			BCWN JIHGFED 5
			BCWN D 0 A_UnSetInvulnerable
			Goto See
		Death:
			TNT1 A 0 
			BCWN D 5 A_Scream
			BCWN E 0
			BCWN E 0 
			BCWN E 4
			BCWN FFFF 2 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN GGGG 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN HHHH 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN IIII 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN JJJJ 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN JJ 10 
			BCWN J 0 
			Stop
		Ice:
			BCWN D 5 A_GenericFreezeDeath
			BCWN D 1 A_FreezeDeathChunks
			wait
	}
}

ACTOR BabyClownNew : EECreature replaces BabyClown 4823
{
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Baby Bouncing Clown"

	Health 88
	Radius 8
	Height 32
	Speed 15
	Mass 60
	PainChance 200
	Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Fire", 0.25
	DamageFactor "Zap", 1.25
	Painchance "Fire", 50
	Painchance "Zap", 250
	MONSTER 
	Scale 0.25
	DropItem ClownSouls 32
	+FLOORCLIP +RANDOMIZE +COUNTKILL +CANPASS
	+LOOKALLAROUND
	MELEEDAMAGE 3
	SeeSound ""
	PainSound "BYHURT"
	DeathSound "BYHURT"
	ActiveSound "BYCLWN"
	MeleeSound "CLWNBITE"
	HitObituary "%o was eaten by a bouncing popcorn clown."
	Obituary "%o was killed by a bouncing popcorn clown."

	dropitem GreenArmor 8
	dropitem BlueArmor 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	States
	{
		Spawn:
			BCWN A 0 NoDelay 
			BCWN AB 4 A_Look
			goto Spawn+1
		See:
			BCWN A 0
			BCWN A 1
			BCWN A 2 
			BCWN B 1
			{
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			BCWN BCC 2
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			BCWN B 2
			Loop
		Melee:
			TNT1 A 0
			BCWN A 3  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			BCWN B 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
				A_StartSound("CLWNBITE");
			}
			BCWN C 4
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
				
				A_CustomMeleeAttack(3*random(1,10),"CLWNBITE");
			}
			BCWN B 3
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			BCWN B 0 A_StartSound("CLWNBITE")
			Goto See
		Pain:
			BCWN B 4 A_EEPain
			Goto See
		Death:
			TNT1 A 0 
			BCWN D 5 A_Scream
			BCWN E 4 A_Fall
			BCWN FFFF 2 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN GGGG 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN HHHH 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN IIII 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN JJJJ 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN K 8 
			BCWN K 0 
			{
				A_StartSound("Popcorn/Steam",CHAN_5,frandom(0.75,1.25),0,ATTN_NORM,0,frandom(0.75,1.25));
				A_StartSound("Popcorn/Steam",CHAN_6,frandom(0.75,1.25),0,ATTN_NORM,0,frandom(0.75,1.25));
			}
			BCWN L 8 A_CustomMissile("cloud1", 12, 0, 0, 1)
			BCWN M 8 A_CustomMissile("cloud1", 12, 0, 1)
			BCWN N -1 A_CustomMissile("cloud1", 12, 0, 0, 1)
			Stop
		Ice:
			BCWN D 5 A_GenericFreezeDeath
			BCWN D 1 A_FreezeDeathChunks
			wait
	}
}

ACTOR BabyClown2New : EECreature replaces BabyClown2 4825
{
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Baby Bouncing Clown"

	Health 75
	Radius 8
	Height 32
	Speed 15
	Mass 60
	PainChance 200
	Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	DamageFactor "Fire", 0.25
	DamageFactor "Zap", 1.25
	Painchance "Fire", 50
	Painchance "Zap", 250
	MONSTER 
	Scale 0.25
	DropItem ClownSouls 32
	+FLOORCLIP +RANDOMIZE +COUNTKILL +CANPASS   
	+LOOKALLAROUND
	MELEEDAMAGE 3
	SeeSound ""
	PainSound "BYHURT"
	DeathSound "BYHURT"
	ActiveSound "BYCLWN"
	MeleeSound "CLWNBITE"
	HitObituary "%o was eaten by a bouncing popcorn clown."
	Obituary "%o was killed by a bouncing popcorn clown."

	dropitem GreenArmor 8
	dropitem BlueArmor 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	States
	{
		Spawn:
			CRWL A 0 NoDelay 
			CRWL A 4 A_Look
			goto Spawn+1
		See:
			PCWN A 0
			PCWN ABC 5
			BCWN A 1
			PCWN A 0
			BCWN A 2 
			BCWN B 1
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			BCWN BCC 2
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			BCWN B 2
			Goto See+5
		Melee:
			TNT1 A 0
			BCWN A 3  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			BCWN B 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
				A_StartSound("CLWNBITE");
			}
			BCWN C 4
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
				
				A_CustomMeleeAttack(3*random(1,10),"CLWNBITE");
			}
			BCWN B 3
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			BCWN B 0 A_StartSound("CLWNBITE")
			Goto See+5
		Pain:
			BCWN B 4 A_EEPain
			Goto See+5
		Death:
			TNT1 A 0 
			BCWN D 5 A_Scream
			BCWN E 4 A_Fall
			BCWN FFFF 2 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN GGGG 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN HHHH 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN IIII 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN JJJJ 1 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
			BCWN K 8 
			BCWN K 0 
			{
				A_StartSound("Popcorn/Steam",CHAN_5,frandom(0.75,1.25),0,ATTN_NORM,0,frandom(0.75,1.25));
				A_StartSound("Popcorn/Steam",CHAN_6,frandom(0.75,1.25),0,ATTN_NORM,0,frandom(0.75,1.25));
			}
			BCWN L 8 A_CustomMissile("cloud1", 12, 0, 0, 1)
			BCWN M 8 A_CustomMissile("cloud1", 12, 0, 1)
			BCWN N -1 A_CustomMissile("cloud1", 12, 0, 0, 1)
			Stop
		Ice:
			BCWN D 5 A_GenericFreezeDeath
			BCWN D 1 A_FreezeDeathChunks
			wait
	}
}

actor PennywiseHead2New : EECreature replaces PennywiseHead 14421
{ 
	//$Angled
	//$Color 12
	//$Category "Happy Time Circus/Monsters"
	Tag "Flying Pennywise Head"

	Health 450
	Speed 11 
	Radius 16
	Height 48
	Mass 400
	Meleedamage 3 
	REACTIONTIME 8 
	PainChance 128
	Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
	Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
	Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy
	DamageFactor "Zap", 1.25
	Painchance "Zap", 160
	DamageFactor "Suck", 2.5
	Painchance "Suck", 256
	MONSTER
	DropItem ClownSouls 100
	+FLOORCLIP +NOGRAVITY +FLOAT +FloatBob +NORADIUSDMG +NOTARGET
	SeeSound ""
	PainSound ""
	DeathSound ""
	ActiveSound ""
	MeleeSound "imp/melee"
	Obituary "%o got killed by a floating apparition of Pennywise's head." 
	MissileHeight 15
	MissileType Ghost2Ball

	dropitem GreenArmor 8
	dropitem GreenArmor 8
	dropitem BlueArmor 8
	dropitem BlueArmor 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem HealthBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	dropitem ArmorBonus 8
	States 
	{
		Spawn:
			CFHD A 0 NoDelay 
			CFHD A 10 A_FloatLook(8)
			goto Spawn+1
		See: 
			CFHD A 0
			CFHD AAAA 1
			{
				A_FloatChaseCheck(2,4,6,8,0.5,0.5);
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(1); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Goto See
		Melee:
			TNT1 A 0
			CFHD D 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			CFHD E 3  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			CFHD D 3 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
				
				A_CustomMeleeAttack(3*random(1,8), "imp/melee");
			}
			CFHD A 3  
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 240) { A_SetTics(1); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(2); }
				A_FaceTarget;
			}
			Goto See
		Missile:
			TNT1 A 0
			CFHD D 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_FaceTarget;
			}
			CFHD E 6 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(3); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 120) { A_SetTics(4); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 60) { A_SetTics(5); }
				A_FaceTarget;

				A_CustomComboAttack("Ghost2Ball", 12, 3*random(1,8), "imp/melee");
			}
			CFHD D 4 
			{
				if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 180) { A_SetTics(2); }
				else if (exex_monsterlevelenabledflags && CountInv("MonsterLevel") > 90) { A_SetTics(3); }
				A_EEChase("Melee","Missile",0,1,3,1,1);
			}
			Goto See
		Pain: 
			CFHD E 4 A_FloatPain(0,4,112) 
			Goto See
		Death:
			TNT1 A 0 
			CFHD F 1 A_Scream 
			CFHD G 2 A_TossGib
			CFHD H 2 A_CustomMissile("BSplatter", 16, 0,0, 1)
			CFHD I 2 A_TossGib
			CFHD J 2 A_NoBlocking 
			CFHD K 2 
			CFHD L 2 A_CustomMissile("HellFire1", 8, 0, -180)
			CFHD M 2 
			CFHD N 2
			Stop   
		Ice:
			CFHD E 5 A_GenericFreezeDeath
			CFHD E 1 A_FreezeDeathChunks
			wait
	}
}

//
actor SkullSeeker666 : EEProjectile
{
	Tag "Skull Seeker"
	Damage (3 * random(1,8))
	Radius 8
	Height 6
	Speed 9
	Scale 1
	+SEEKERMISSILE
	PROJECTILE
	//RENDERSTYLE ADD
	//ALPHA 0.67
	SeeSound ""	
	DeathSound "BHIT3"
	States
	{
		Spawn:
			GHST ABABABABABABABABABABAB 4 A_SeekerMissile (5,20)
			GHST ABABABABABAB 4 A_SeekerMissile (5,20)
			GHST ABABABABABABABABCDEFG 4 A_SeekerMissile (5,20)
			Stop
		Death:
			GHST CDEFG 4 Bright
			Stop
	}
}

// Weapons
ACTOR PopcornGunNew : Circus2Weapon replaces PopcornGun 30204
{
	Tag "Popcorn Gun"
	Weapon.SelectionOrder 100
	Inventory.PickupSound "misc/w_pkup"
	Weapon.AmmoType "PopcornPiece" 
	Weapon.AmmoGive 20 
	Weapon.AmmoUse 1
	Inventory.Pickupmessage "You got the \cjPopcorn Gun\c-! Don't eat the popcorn... \cx[Slot 7]\c-" 
	Obituary "%o ate some of %k's popcorn."
	AttackSound "" 
	Scale 0.75
	States 
	{
		Spawn: 
			PPPG A -1 
			loop
		Ready: 
			PGUN AAACCCDDDEEEFFFGGG 1 A_WeaponReady(WRF_ALLOWUSER4)
			loop
		Deselect: 
			PGUN A 1  
			{
				A_Lower(12);
			}
			loop
		Select: 
			PGUN A 1
			{
				A_Raise(12);
			}
			loop
		Fire:
			PGUN A 0 A_Jump (200,"FirePhase2")
			PGUN A 4
			{
				A_StartSound("POPFIRE");
				A_FireProjectile("Popcorn1",-1,1,4,1,0,0);
				A_FireProjectile("Popcorn2",0,0,6,1,0,0);
			}
			PGUN B 2 
			{
				A_FireProjectile("Popcorn3",1,0,5,1,0,0);
			}
		FirePhase2:
			PGUN A 0 A_Jump (144,"FirePhase3")
			PGUN A 0 A_StartSound("POPFIRE")
			PGUN A 2
			{
				A_FireProjectile("Popcorn11",-1,0,4,2,0,0);
				A_FireProjectile("Popcorn2",-4,1,5,1,0,0);
				A_FireProjectile("Popcorn1",2,0,4,1,0,0);
			}
		FirePhase3:
			PGUN A 0 A_Jump (128,"FirePhase4")
			PGUN A 4 
			{
				A_StartSound("POPFIRE");
				A_FireProjectile("Popcorn3",-2,0,3,1,0,0);
			}
			PGUN B 2 
			{
				A_FireProjectile("Popcorn2",-2,1,4,-2,0,0);
				A_FireProjectile("Popcorn2",4,0,0,1,0,0);
			}
		FirePhase4:
			PGUN A 0 A_Jump (96,"FirePhase5")
			PGUN A 0 
			{
				A_StartSound("POPFIRE");
				A_FireProjectile("Popcorn2",-3,0,4,1,0,0);
				A_FireProjectile("Popcorn3",3,0,0,1,0,0);
			}
		FirePhase5:
			PGUN A 0 A_Jump (96,"FirePhase6")
			PGUN A 2 
			{
				A_FireProjectile("Popcorn1",3,0,5,1,0,0);
			}
			PGUN B 1 
			{
				A_StartSound("POPFIRE");
				A_FireProjectile("Popcorn2",0,0,0,1,0,0);
				A_FireProjectile("Popcorn3",-2,1,0,1,0,0);
			}
		FirePhase6:
			PGUN A 0 A_Jump (64,"FirePhase7")
			PGUN A 4 
			{
				A_StartSound("POPFIRE");
				A_FireProjectile("Popcorn3",-1,0,4,1,0,0);
			}
			PGUN A 2 
			{
				A_FireProjectile("Popcorn2",1,0,4,1,0,0);
			}
		FirePhase7:
			PGUN A 0 A_Jump (64,"FirePhase8")
			PGUN B 1
			{
				A_FireProjectile("BurntPopcorn1",0,0,5,1,0,0);
			}
		FirePhase8:
			PGUN A 0 A_Jump (128,"FirePhaseEnd")
			PGUN A 1
			{
				A_FireProjectile("BurntPopcorn1",0,0,5,1,0,0);
			}
		FirePhaseEnd:
			PGUN A 0 
			Goto Ready 
	}
}

ACTOR GoreBalloonNew : Circus2Weapon replaces GoreBalloon 30030
{
	Tag "Explosive Gore Balloon"
	Weapon.SelectionOrder 1500
	Inventory.PickupSound "misc/w_pkup" 
	Weapon.AmmoType "GoreBalloons" 
	Weapon.AmmoGive 5 
	Weapon.AmmoUse 1
	Inventory.Pickupmessage "You got some \cjgore balloons\c-! \cx[Slot 4]\c-" 
	Obituary "%o wanted %k's balloon."
	Scale 0.75
	States 
	{
		Spawn: 
			BLNN J -1 
			loop
		Ready: 
			BLND ABCD 6 A_WeaponReady(WRF_ALLOWUSER4)
			loop
		Deselect: 
			BLND E 1
			{
				A_Lower(12);
			}
			Loop
		Select: 
			BLND E 1
			{
				A_Raise(12);
			}
			Loop
		Fire: 
			BLND A 1 
			{
			}
			BLND F 2
			{
			}
			BLND G 2
			{
			}
			TNT1 A 0
			{
				A_FireProjectile("GoreBalloon666",0,1,4,1,0,0);
			}
			BLND I 6
			{
			}
			BLND I 6
			{
			}
			BLND H 6
			{
			}
			TNT1 A 0 
			Goto Select
	}
}
actor GoreBalloon666 : EEProjectile
{
	Tag "Gore Balloon"
	Radius 8
	Height 6
	Speed 13
	Damage (finaldamagedealt) // 6
	scale 1
	+SeeKERMISSILE +FloatBob 
	PROJECTILE
	ALPHA 0.8
	SeeSound ""
	DeathSound "pop1"
	States
	{
		Spawn:
			BOON A 0 NoDelay
			{
				finaldamagedealt = 6 * random(1,8);
			}
			BOON A 4 A_SeekerMissile(30,40)
			BOON A 4 A_CustomMissile("Blood", 24, 0, 0, 1)
			Goto Spawn
		Death:
			BOON B 2 A_Scream
			BOON C 2 A_Fall
			BOON C 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON D 1 A_CustomMissile("BSplatter", 0, 0, 45, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON D 1 A_TossGib
			BOON E 1 A_CustomMissile("FlyingGut", 4, 0, 225, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON C 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON E 1 A_TossGib
			BOON E 1 A_CustomMissile("FlyingGut", 8, 0, 90, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON F 1 A_CustomMissile("FlyingGut", 12, 0, 270, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON F 1 A_TossGib
			BOON F 0 A_CustomMissile("FlyingGut", 12, 0, 30, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON C 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON F 0 A_CustomMissile("FlyingGut", 12, 0, 270, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON C 0 A_CustomMissile("FlyingGut", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON C 0 A_CustomMissile("FlyingGut", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON C 0 A_CustomMissile("FlyingGut", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON F 1 A_TossGib
			BOON F 1 A_CustomMissile("BSplatter", 4, 0, -90, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON F 0 A_CustomMissile("BloodSpeck3", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON F 0 A_CustomMissile("FlyingGut", 4, 0, -300, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON G 1 A_CustomMissile("FlyingGut", 8, 0, 180, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON G 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON G 1 A_TossGib
			BOON G 0 A_CustomMissile("FlyingGut", 8, 0, 300, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON G 0 A_CustomMissile("BloodSpeck3", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON G 0 A_Jump (240,2) 
			BOON G 0 A_CustomMissile("GoreWorm", 16, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON C 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON G 0 A_TossGib
			BOON G 0 A_TossGib
			BOON G 0 A_TossGib
			BOON G 0 A_TossGib
			BOON G 1 A_TossGib
			BOON G 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON G 1 A_CustomMissile("FlyingGut", 0, 0, 45, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON G 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			Stop
	}
}

actor GoreBalloon666Berserk : GoreBalloon666
{
	Tag "Gore Balloon"
	Radius 8
	Height 6
	Speed 36
	Damage (finaldamagedealt) // 6
	scale 1
	+SeeKERMISSILE +FloatBob 
	PROJECTILE
	ALPHA 0.8
	SeeSound ""
	DeathSound "pop1"
	States
	{
		Spawn:
			BOON A 0 NoDelay
			{
				finaldamagedealt = 60 * random(1,8);
			}
			BOON A 2 A_SeekerMissile(30,40)
			BOON A 2 A_CustomMissile("Blood", 24, 0, 0, 1)
			Goto Spawn
		Death:
			BOON B 1 A_Scream
			BOON C 1 A_Fall
			BOON C 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON D 1 A_CustomMissile("BSplatter", 0, 0, 45, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON D 1 A_TossGib
			BOON E 1 A_CustomMissile("FlyingGutBerserk", 4, 0, 225, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON C 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON E 1 A_TossGib
			BOON E 1 A_CustomMissile("FlyingGutBerserk", 8, 0, 90, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON F 1 A_CustomMissile("FlyingGutBerserk", 12, 0, 270, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON F 1 A_TossGib
			BOON F 0 A_CustomMissile("FlyingGutBerserk", 12, 0, 30, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON C 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON F 0 A_CustomMissile("FlyingGutBerserk", 12, 0, 270, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON C 0 A_CustomMissile("FlyingGutBerserk", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON C 0 A_CustomMissile("FlyingGutBerserk", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON C 0 A_CustomMissile("FlyingGutBerserk", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON F 1 A_TossGib
			BOON F 1 A_CustomMissile("BSplatter", 4, 0, -90, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON F 0 A_CustomMissile("BloodSpeck3", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON F 0 A_CustomMissile("FlyingGutBerserk", 4, 0, -300, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON G 1 A_CustomMissile("FlyingGutBerserk", 8, 0, 180, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON G 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON G 1 A_TossGib
			BOON G 0 A_CustomMissile("FlyingGutBerserk", 8, 0, 300, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON G 0 A_CustomMissile("BloodSpeck3", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON G 0 A_Jump (240,2) 
			BOON G 0 A_CustomMissile("GoreWorm", 16, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON C 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON G 0 A_TossGib
			BOON G 0 A_TossGib
			BOON G 0 A_TossGib
			BOON G 0 A_TossGib
			BOON G 1 A_TossGib
			BOON G 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON G 1 A_CustomMissile("FlyingGutBerserk", 0, 0, 45, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON G 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			Stop
	}
}
actor GoreBalloon666NoHurt : EEProjectile
{
	Tag "Gore Balloon"
	Radius 8
	Height 6
	Speed 13
	Damage (finaldamagedealt) // 6
	scale 1
	+SEEKERMISSILE +FloatBob 
	PROJECTILE
	ALPHA 0.8
	SeeSound ""
	DeathSound "pop1"
	States
	{
		Spawn:
			BOON A 0 NoDelay
			{
				finaldamagedealt = 6 * random(1,8);
			}
			BOON A 4 A_SeekerMissile (30,40)
			BOON A 4 A_CustomMissile("Blood", 24, 0, 0, CMF_AIMOFFSET)
			Goto Spawn
		Death:
			BOON B 2 A_Scream
			BOON C 2 A_Fall
			BOON C 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON D 1 A_CustomMissile("BSplatter", 0, 0, 45, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON D 1 A_TossGib
			BOON E 1 A_CustomMissile("FlyingGutNoHurt", 4, 0, 225, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON C 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON E 1 A_TossGib
			BOON E 1 A_CustomMissile("FlyingGutNoHurt", 8, 0, 90, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON F 1 A_CustomMissile("FlyingGutNoHurt", 12, 0, 270, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON F 1 A_TossGib
			BOON F 0 A_CustomMissile("FlyingGutNoHurt", 12, 0, 30, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON C 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON F 0 A_CustomMissile("FlyingGutNoHurt", 12, 0, 270, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON C 0 A_CustomMissile("FlyingGutNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON C 0 A_CustomMissile("FlyingGutNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON C 0 A_CustomMissile("FlyingGutNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON F 1 A_TossGib
			BOON F 1 A_CustomMissile("BSplatter", 4, 0, -90, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON F 0 A_CustomMissile("BloodSpeck3", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON F 0 A_CustomMissile("FlyingGutNoHurt", 4, 0, -300, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON G 1 A_CustomMissile("FlyingGutNoHurt", 8, 0, 180, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON G 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON G 1 A_TossGib
			BOON G 0 A_CustomMissile("FlyingGutNoHurt", 8, 0, 300, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON G 0 A_CustomMissile("BloodSpeck3", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON G 0 A_Jump (240,2) 
			BOON G 0 A_CustomMissile("GoreWorm", 16, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON C 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON G 0 A_TossGib
			BOON G 0 A_TossGib
			BOON G 0 A_TossGib
			BOON G 0 A_TossGib
			BOON G 1 A_TossGib
			BOON G 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			BOON G 1 A_CustomMissile("FlyingGutNoHurt", 0, 0, 45, CMF_AIMOFFSET|CMF_TRACKOWNER)
			BOON G 0 A_CustomMissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			Stop
	}
}

ACTOR ClownGrenadeNew : Circus2Weapon replaces ClownGrenade 30029
{
	Tag "Clownish Grenade"
	Weapon.SelectionOrder 1400
	Inventory.PickupSound "misc/w_pkup" 
	Weapon.AmmoType "CGrenadeAmmo" 
	Weapon.AmmoGive 5 
	Weapon.AmmoUse 1
	Inventory.Pickupmessage "You picked up some \cjclown grenades\c- \cx[Slot 6]\c-"
	AttackSound "" 
	+FloatBob 
	Scale 0.3
	States 
	{
		Spawn: 
			CGRD ABCDEFGHIJKL 3
			loop
		Ready: 
			GHND ABCDEFFFFFEDCBAA 1 A_WeaponReady(WRF_ALLOWUSER4) 
			loop
		Deselect: 
			GHND A 1
			{
				A_Lower(12);
			}
			loop
		Select: 
			GHND A 1 
			{
				A_Raise(12);
			}
			loop
		Fire: 
			GHND I 4
			{
				A_FireProjectile("CGrenade",0,1,0,1,0,0);
			}
			GHND G 4 
			{
			}
			GHND H 10 
			{
			}
			Goto Ready 
	}
}

ACTOR GutFlingerNew : Circus2Weapon replaces GutFlinger 30028
{
	Tag "The Gutflinger"
	Weapon.SelectionOrder 1150
	Inventory.PickupSound "misc/w_pkup" 
	Weapon.AmmoType "ClownSouls" 
	Weapon.AmmoType2 "ClownSouls"
 	Weapon.AmmoGive 5 
	Weapon.AmmoUse1 1
	Weapon.AmmoUse2 1
	Inventory.Pickupmessage "You got the \cjGut Flinger\c-! \cx[Slot 2]\c-" 
	AttackSound "" 
	Scale 1
	States 
	{
		Spawn: 
			CCCC F -1 
			loop
		Ready: 
			CCCC A 1 A_WeaponReady(WRF_ALLOWUSER4) 
			loop
		Deselect: 
			CCCC A 1 
			{
				A_Lower(12);
			}
			loop
		Select: 
			CCCC A 1 
			{
				A_Raise(12);
			}
			loop
		Fire:
			CCCC A 1 A_JumpIfNoAmmo("FireNoAmmo") 
			CCCC B 1
			{
				A_StartSound("GUTFIRE");
				A_FireProjectile("FlyingGut",0,1,5.0,1,0,0);
			}
			CCCC E 1
			CCCC EDCB 3
			Goto Ready 
		FireNoAmmo:
			CCCC E 0
			Goto Deselect
		AltFire:
			CCCC A 1
			{
				if (CountInv("ClownSouls") <= 0)
				{
					return state("AltFireNoAmmo");
				}
				return state("");
			}
			CCCC B 1
			{
				A_StartSound("GUTFIRE");
				A_FireProjectile("FlyingGut",frandom(-(A_GetHitScanXSpread(16)),(A_GetHitScanXSpread(16))),1,5.0,1,0,frandom(-(A_GetHitScanYSpread(16)),(A_GetHitScanYSpread(16))));
			}
			CCCC E 1
			CCCC E 1
			CCCC D 1
			CCCC C 1
			Goto Ready 
		AltFireNoAmmo:
			CCCC E 0
			Goto Ready
	}
} 

actor FlyingGut : EEProjectile
{
	Tag "Explosive Gut"
	Radius 8
	Height 6
	Speed 13
	Damage (finaldamagedealt) // 5
	Scale 0.8
	+Missile
	+Lowgravity
	DropItem Blood
	DropItem Blood
	DropItem Blood
	DropItem Blood
	ExplosionRadius 80
	ExplosionDamage 48
	DeathSound "splat11"
	States
	{
		Spawn:
			SPLT ABCDEF 3 NoDelay
			{
				finaldamagedealt = 5 * random(1,8);
			}
			Loop
		Death:
			BBLD A 2 A_Explode(128,80,1)
			BBLD A 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD A 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD AB 2 A_CustomMissile("ZGut2", 0, 0, 180) 
			BBLD B 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD B 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD BC 2 A_CustomMissile("ZGut3", 0, 0, 180) 
			BBLD C 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD C 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD D 4 
			BBLD D 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD D 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD D 0 A_CustomMissile("BloodSpeck2", 8,0, random(-180, 180), 2, random(-180, 180))
			BBLD E 2 
			BBLD E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD E 3 
			Stop
	}
}

actor FlyingGutBerserk : EEProjectile
{
	Tag "Explosive Gut"
	Radius 8
	Height 6
	Speed 19
	Damage (finaldamagedealt) // 5
	Scale 0.8
	+Missile
	+Lowgravity
	DropItem Blood
	DropItem Blood
	DropItem Blood
	DropItem Blood
	ExplosionRadius 80
	ExplosionDamage 48
	DeathSound "splat11"
	States
	{
		Spawn:
			SPLT ABCDEF 3 NoDelay
			{
				finaldamagedealt = random(12,13) * random(1,8);
			}
			Loop
		Death:
			BBLD A 2 A_Explode(128,80,1)
			BBLD A 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD A 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD AB 2 A_CustomMissile("ZGut2", 0, 0, 180) 
			BBLD B 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD B 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD BC 2 A_CustomMissile("ZGut3", 0, 0, 180) 
			BBLD C 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD C 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD D 4 
			BBLD D 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD D 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD D 0 A_CustomMissile("BloodSpeck2", 8,0, random(-180, 180), 2, random(-180, 180))
			BBLD E 2 
			BBLD E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD E 3 
			Stop
	}
}
// FlyingGut with no-damage [for player] explosion (for spread aura)
actor FlyingGutNoHurt : EEProjectile
{
	Tag "Explosive Gut"
	Radius 8
	Height 6
	Speed 13
	Damage (finaldamagedealt) // 5
	Scale 0.8
	+Missile
	+Lowgravity
	DropItem Blood
	DropItem Blood
	DropItem Blood
	DropItem Blood
	ExplosionRadius 80
	ExplosionDamage 48
	DeathSound "splat11"
	States
	{
		Spawn:
			SPLT ABCDEF 3 NoDelay
			{
				finaldamagedealt = 5 * random(1,8);
			}
			Loop
		Death:
			BBLD A 2 A_Explode(128,80,0)
			BBLD A 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD A 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD AB 2 A_CustomMissile("ZGut2", 0, 0, 180) 
			BBLD B 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD B 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD BC 2 A_CustomMissile("ZGut3", 0, 0, 180) 
			BBLD C 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD C 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD D 4 
			BBLD D 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD D 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD D 0 A_CustomMissile("BloodSpeck2", 8,0, random(-180, 180), 2, random(-180, 180))
			BBLD E 2 
			BBLD E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD E 0 A_CustomMissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
			BBLD E 3 
			Stop
	}
}

ACTOR GasRocketLauncherNew : Circus2Weapon replaces GasRocketLauncher 30203
{
	Tag "ClownGas Rocket Launcher"
	Weapon.SelectionOrder 1050
	Inventory.PickupSound "misc/w_pkup" 
	Weapon.AmmoType "ClownSouls" 
	Weapon.AmmoType2 "ClownSouls" 
	Weapon.AmmoGive 20 
	Weapon.AmmoUse1 5
	Weapon.AmmoUse2 5
	Inventory.Pickupmessage "You got the \cjGas Rocket Launcher\c-! \cx[Slot 5]\c-" 
	Obituary "%o choked on %k's gas."
	AttackSound "" 
	Scale 0.75
	States 
	{
		Spawn: 
			PRCK V -1 
			loop
		Ready: 
			PRCK G 1 A_WeaponReady(WRF_ALLOWUSER4) 
			loop
		Deselect: 
			PRCK G 1 
			{
				A_Lower(12);
			}
			loop
		Select: 
			PRCK D 1
			{
				A_Raise(12);
			}
			loop
		Fire:
			PRCK G 0 
			{
				A_FireProjectile("RevRocket2",0,5,4,1,0,0);
			}
			PRCK W 4 
			PRCK A 4 A_StartSound("RRELOAD")
			PRCK BCDEFG 4
			Goto Ready 
		AltFire:
			PRCK G 0 
			{
				if (CountInv("ClownSouls") <= 4)
				{
					return state("Ready");
				}
				return state("");
			}
			PRCK G 0 
			{
				A_FireProjectile("RevRocket2",frandom(-(A_GetHitScanXSpread(17)),(A_GetHitScanXSpread(17))),5,4,1,0,frandom(-(A_GetHitScanYSpread(17)),(A_GetHitScanYSpread(17))));
			}
			PRCK W 1 
			PRCK A 1 A_StartSound("RRELOAD")
			PRCK BCDEFG 1
			Goto Ready 
	}
} 
actor RevRocket2 : EEProjectile
{
	Tag "Happy Gas Rocket"
	Speed 18
	Damage (finaldamagedealt) // 5
	Radius 8
	Height 6
	Scale 0.55
	+SEEKERMISSILE
	PROJECTILE
	SeeSound "REVRCK"
	DeathSound "EXPLODE"
	ExplosionRadius 96
	ExplosionDamage 12
	States
	{
		Spawn:
			RRCK A 0 NoDelay 
			{
				finaldamagedealt = 5 * random(1,8);
			}
			RRCK A 1 A_SeekerMissile (30,40)
			RRCK A 1 A_CustomMissile("RevTrail",0, 0, 0)
			RRCK A 1 A_StartSound("HISS")
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), 2, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)  
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), 2, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)  
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1) 
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), 2, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)  
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)  
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), 2, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), 2, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, 1)  
			Loop
		Death:
			GLOB A 4 Bright 
			GLOB B 4 Bright A_Explode(128,96,0)
			GLOB B 2 Bright A_CustomMissile("HappyCloudPlayer", 16, 8, 135, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB BBBBBBB 0 A_CustomMissile("Sparkles", 4,4, random(-180, 180), 2, random(-180, 180))
			GLOB B 2 Bright A_CustomMissile("HappyCloudPlayer", 12, 0, 90, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB B 2 Bright A_CustomMissile("HappyCloudPlayer", 16, -8, -135, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB C 2 Bright A_CustomMissile("HappyCloudPlayer", 16, 0, -200, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB CCCCCCC 0 A_CustomMissile("Sparkles", 4, 4, random(-180, 180), 2, random(-180, 180))
			GLOB D 2 Bright A_CustomMissile("HappyCloudPlayer", 18, 0, 45, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB E 2 Bright A_CustomMissile("HappyCloudPlayer", 16, 8, 300, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB E 2 Bright A_CustomMissile("HappyCloudPlayer", 16, 0, 200, CMF_AIMOFFSET|CMF_TRACKOWNER)
			GLOB EEEEEEE 0 A_CustomMissile("Sparkles", 4, 4, random(-180, 180), 2, random(-180, 180))
			GLOB F 2 Bright A_CustomMissile("HappyCloudPlayer", 22, -8, 315, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB G 2 Bright A_CustomMissile("HappyCloudPlayer", 16, 0, 270, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB G 2 Bright A_CustomMissile("HappyCloudPlayer", 12, 8, 180, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB H 4 Bright 
			Stop
	}
}
actor RevRocket2NoHurt : EEProjectile
{
	Speed 18
	Damage (finaldamagedealt) // 5
	Radius 8
	Height 6
	Scale 0.55
	+SEEKERMISSILE
	PROJECTILE
	SeeSound "REVRCK"
	DeathSound "EXPLODE"
	ExplosionRadius 96
	ExplosionDamage 12
	States
	{
		Spawn:
			RRCK A 0 NoDelay 
			{
				finaldamagedealt = 5 * random(1,8);
			}
			RRCK A 1 A_SeekerMissile (30,40)
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)
			RRCK A 1 A_StartSound("HISS")
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)  
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)  
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)  
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)  
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)
			RRCK A 0 A_CustomMissile("ClownSpark", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)  
			Loop
		Death:
			GLOB A 4 Bright 
			GLOB B 4 Bright A_Explode(128,96,0)
			GLOB B 2 Bright A_CustomMissile("HappyCloudPlayer", 16, 8, 135, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB BBBBBBB 0 A_CustomMissile("Sparkles", 4,4, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			GLOB B 2 Bright A_CustomMissile("HappyCloudPlayer", 12, 0, 90, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB B 2 Bright A_CustomMissile("HappyCloudPlayer", 16, -8, -135, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB C 2 Bright A_CustomMissile("HappyCloudPlayer", 16, 0, -200, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB CCCCCCC 0 A_CustomMissile("Sparkles", 4, 4, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			GLOB D 2 Bright A_CustomMissile("HappyCloudPlayer", 18, 0, 45, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB E 2 Bright A_CustomMissile("HappyCloudPlayer", 16, 8, 300, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB E 2 Bright A_CustomMissile("HappyCloudPlayer", 16, 0, 200, CMF_AIMOFFSET|CMF_TRACKOWNER)
			GLOB EEEEEEE 0 A_CustomMissile("Sparkles", 4, 4, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
			GLOB F 2 Bright A_CustomMissile("HappyCloudPlayer", 22, -8, 315, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB G 2 Bright A_CustomMissile("HappyCloudPlayer", 16, 0, 270, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB G 2 Bright A_CustomMissile("HappyCloudPlayer", 12, 8, 180, CMF_AIMOFFSET|CMF_TRACKOWNER) 
			GLOB H 4 Bright 
			Stop
	}
}

actor MyBall : EEProjectile
{
	Tag "Bingo Shot"
	Radius 8
	Height 6
	Speed 15
	Damage 1
	scale 0.5
	//+SeeKERMISSILE
	PROJECTILE
	ALPHA 0.8
	SeeSound "TINY"
	DeathSound "imp/shotx"
	States
	{
		Spawn:
			ORBB AB 0 A_SeekerMissile (10,10)  
			ORBB AB 0   
			ORBB AB 2 bright A_CStaffMissileSlither 
			Goto Spawn + 2
		Death:
			ORBB C 4 Bright A_Scream
			ORBB D 4 Bright A_Fall
			ORBB E 4 Bright 
			Stop
	}
}
actor BulbBallDrop : EEProjectile
{
	Tag "Small Bulby Ball Drop"
	Radius 6
	Height 16
	Speed 10
	Damage 3
	scale 0.9
	PROJECTILE
	ALPHA 0.8
	DeathSound "BULBEXP"
	ExplosionRadius 80
	ExplosionDamage 48
	DamageType "Electric"
	States
	{
		Spawn:
			BBBL AB 0 A_LowGravity  
			BBBL AABBCCBB 2 bright
			Goto Spawn + 1
		Death:
			BBBL D 2 Bright A_Fall
			BBBL D 4 Bright A_Explode
			BBBL E 4 Bright A_Scream
			BBBL FG 4 Bright 
			Stop
	}
}
ACTOR HellFire2 : EEProjectile
{
	Tag "Clown Ghost Hellfire"
	+NOCLIP +MISSILE +DROPOFF +RANDOMIZE +FLOORHUGGER 
	Scale 1.5
	Speed 0
	Damage 0
	RENDERSTYLE ADD
	ALPHA 0.67
	ExplosionDamage 4
	ExplosionRadius 64
	DamageType "Fire"
	DeathSound ""
	States
	{
		Spawn:
			RAIN B 4
			GHFF ABC 3 Bright
			GHFF C 0
			{
				A_Explode(4,64);
				if (random(1,256) <= 16)
				{
					A_CustomMissile("HellFire2", 0, 24, 0, CMF_TRACKOWNER);
					A_CustomMissile("HellFire2", 0, 0, 0, CMF_TRACKOWNER);
					A_CustomMissile("HellFire2", 0, -24, 0, CMF_TRACKOWNER);
				}
			}
			GHFF DEFGHIJ 3 Bright
			Stop
	}
}

ACTOR HellFire1 : EEProjectile
{
	Tag "Clown Ghost Hellfire"
	+NOCLIP
	+MISSILE
	+DROPOFF
	Speed 2
	Damage 0
	DamageType "Fire"
	States
	{
		Spawn:
			RAIN B 10 A_CustomMissile("HellFire2", 0, 0, 0, CMF_TRACKOWNER)
			RAIN B 10 A_CustomMissile("HellFire2", 0, 16, 0, CMF_TRACKOWNER)
			RAIN B 10 A_CustomMissile("HellFire2", 0, -16, 0, CMF_TRACKOWNER)
			RAIN B 10 A_CustomMissile("HellFire2", 0, 0, 0, CMF_TRACKOWNER)
			RAIN B 10 A_CustomMissile("HellFire2", 0, 16, 0, CMF_TRACKOWNER)
			Stop
	}
}

ACTOR HellFire : EEProjectile
{
	Tag "Clown Ghost Hellfire"
	+NOBLOCKMAP
	+MISSILE
	+DROPOFF
	Speed 5
	Damage 0
	DeathSound ""
	DamageType "Fire"
	States
	{
		Spawn:
			RAIN B 1
			Loop
		Death:
			RAIN B 0 Bright A_CustomMissile("HellFire1", 0, 0, -180, CMF_TRACKOWNER)
			RAIN B 0 Bright A_CustomMissile("HellFire1", 0, 16, -175, CMF_TRACKOWNER)
			RAIN B 0 Bright A_CustomMissile("HellFire1", 0, 32, -170, CMF_TRACKOWNER)
			RAIN B 0 Bright A_CustomMissile("HellFire1", 0, -16, -185, CMF_TRACKOWNER)
			RAIN B 0 Bright A_CustomMissile("HellFire1", 0, -32, -190, CMF_TRACKOWNER)
			Stop
	}
}
actor SpiralBall : EEProjectile
{
	Radius 8
	Height 6
	Speed 14
	Damage 5
	scale 1
	+SeeKERMISSILE +FloatBob 
	PROJECTILE
	ALPHA 0.8
	SeeSound "TINY"
	DeathSound "imp/shotx"
	States
	{
		Spawn:
			ORBB AB 1 bright A_CStaffMissileSlither 
			Goto Spawn
		Death:
			ORBB C 4 Bright A_Scream
			ORBB D 4 Bright A_Fall
			ORBB E 4 Bright 
			Stop
	}
}
actor CGrenade : EEProjectile
{
	Tag "Clown Grenade"
	Radius 8
	Height 16
	Speed 25
	Damage (finaldamagedealt) // 2
	Scale 0.5
	+Missile +NOTELEPORT
	+BOUNCEONWALLS
	+BOUNCEONFLOORS
	+BOUNCEONCEILINGS
	+BOUNCEONACTORS
	+NOBOUNCESOUND
	+CANBOUNCEWATER
	+USEBOUNCESTATE
	SeeSound ""
	DeathSound ""
	ExplosionRadius 256
	ExplosionDamage 128
	BounceType "Hexen"
	BounceFactor 0.5
	WallBounceFactor 0.5
	BounceCount 4
	
	States
	{
		Spawn:
			CGRD A 0 Nodelay
			{
				bouncecount = random(3,4);
			}
		Idle:
			CGRD ABCDEFGHIJKL 3 
			{
				finaldamagedealt = 2 * random(1,8);
				A_CustomMissile("cloud", 4, 0, 0, 1);
			}
			Loop
		Bounce:
			TNT1 A 0 
			{
				A_StartSound("randomboing",CHAN_5,1.0,0,ATTN_NORM,0,frandom(0.75,1.25));
			}
			goto Idle
		Bounce.Actor:
		Bounce.Actor.Creature:
			Goto Explode
		Death: 
			CGRD M 0 A_Jump (128,12)
			CGRD MMMMMMMMMM 3
			CGRD M 0 A_Jump (255,11)
			CGRD NNNNNNNNNN 3
		Explode:
			PBFF A 0
			{
				A_ChangeFlag("NOGRAVITY",1);
				A_ScaleVelocity(0.0,0.0);
			}
			PBFF A 0 A_Explode(128,256,0)
			PBFF A 0 A_StartSound("BULBEXP") 
			GHFF AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_CustomMissile("GrenadeSpark", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
			GHFF AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_CustomMissile("GrenadeSpark", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
			GHFF A 1
			GHFF AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_CustomMissile("GrenadeSpark", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))        
			GHFF AAAAAAAAAAAAAAAAA 0 A_CustomMissile("GrenadeSpark2", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
			GHFF BC 4 A_CustomMissile("GrenadeSpark", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
			GHFF DDDDEEEE 1 
			GHFF FFFFGGGG 1 
			GHFF HI 4 
			GHFF J 4 
			Stop
	}
}
actor CGrenadeBerserk : CGrenade
{
	Tag "Clown Grenade"
	Radius 8
	Height 16
	Speed 63
	Damage (finaldamagedealt) // 2
	Scale 0.5
	+Missile +NOTELEPORT
	+BOUNCEONWALLS
	+BOUNCEONFLOORS
	+BOUNCEONCEILINGS
	+BOUNCEONACTORS
	+NOBOUNCESOUND
	+CANBOUNCEWATER
	+USEBOUNCESTATE
	SeeSound ""
	DeathSound ""
	ExplosionRadius 256
	ExplosionDamage 128
	BounceType "Hexen"
	BounceFactor 0.75
	WallBounceFactor 0.75
	BounceCount 6
	
	States
	{
		Spawn:
			CGRD A 0 Nodelay
			{
				bouncecount = random(3,4);
			}
		Idle:
			CGRD ABCDEFGHIJKL 3 
			{
				finaldamagedealt = 20 * random(1,8);
				A_CustomMissile("cloud", 4, 0, 0, 1);
			}
			Loop
		Bounce:
			TNT1 A 0 
			{
				A_StartSound("randomboing",CHAN_5,1.0,0,ATTN_NORM,0,frandom(0.75,1.25));
			}
			goto Idle
		Bounce.Actor:
		Bounce.Actor.Creature:
			Goto Explode
		Death: 
			CGRD M 0 A_Jump (128,12)
			CGRD MMMMMMMMMM 3
			CGRD M 0 A_Jump (255,11)
			CGRD NNNNNNNNNN 3
		Explode:
			PBFF A 0
			{
				A_ChangeFlag("NOGRAVITY",1);
				A_ScaleVelocity(0.0,0.0);
			}
			PBFF A 0 A_Explode(128,256,0)
			PBFF A 0 A_StartSound("BULBEXP") 
			GHFF AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_CustomMissile("GrenadeSpark", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
			GHFF AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_CustomMissile("GrenadeSpark", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
			GHFF A 1
			GHFF AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_CustomMissile("GrenadeSpark", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))        
			GHFF AAAAAAAAAAAAAAAAA 0 A_CustomMissile("GrenadeSpark2", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
			GHFF BC 4 A_CustomMissile("GrenadeSpark", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
			GHFF DDDDEEEE 1 
			GHFF FFFFGGGG 1 
			GHFF HI 4 
			GHFF J 4 
			Stop
	}
}
actor CGrenadeNoHurt : CGrenade
{
	States
	{
		Spawn:
			CGRD A 0 Nodelay
			{
				bouncecount = random(3,4);
			}
		Idle:
			CGRD ABCDEFGHIJKL 3
			{
				finaldamagedealt = 2 * random(1,8);
				A_CustomMissile("cloud", 4, 0, 0, 1);
			}
			Goto Idle 
		Bounce:
			TNT1 A 0 
			{
				A_StartSound("randomboing",CHAN_5,1.0,0,ATTN_NORM,0,frandom(0.75,1.25));
			}
			goto Idle
		Bounce.Actor:
		Bounce.Actor.Creature:
			Goto Explode
		Death: 
			CGRD M 0 A_Jump (128,12)
			CGRD MMMMMMMMMM 3
			CGRD M 0 A_Jump (255,11)
			CGRD NNNNNNNNNN 3
		Explode:
			PBFF A 0
			{
				A_ChangeFlag("NOGRAVITY",1);
				A_ScaleVelocity(0.0,0.0);
			}
			PBFF A 0 A_Explode(128,256,0)
			PBFF A 0 A_StartSound("BULBEXP") 
			GHFF AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_CustomMissile("GrenadeSparkNoHurt", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
			GHFF AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_CustomMissile("GrenadeSparkNoHurt", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
			GHFF A 1
			GHFF AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_CustomMissile("GrenadeSparkNoHurt", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))    
			GHFF AAAAAAAAAAAAAAAAA 0 A_CustomMissile("GrenadeSpark2NoHurt", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
			GHFF BC 4 A_CustomMissile("GrenadeSparkNoHurt", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
			GHFF DDDDEEEE 1 
			GHFF FFFFGGGG 1 
			GHFF HI 4 
			GHFF J 4 
			Stop
	}
}

Actor GrenadeSpark : EEProjectile
{
	Tag "Clown Grenade Debris"
	Radius 2
	Height 2
	Speed 17
	+Missile +NOTELEPORT
	scale 1
	damage (finaldamagedealt) // 8
	SeeSound ""
	DeathSound ""
	States
	{
		Spawn:
			//CRZY R 2 Bright ThrustThing( (angle*random(-256,256))/360, 4, 0, 0)
			CRZY R 1 Bright NoDelay
			{
				finaldamagedealt = 5 * random(1,8);
			}
			Goto Spawn
		Death:
			PWT2 G 3 Bright 
			PWT2 H 3 Bright 
			PWT2 IIIIIIIII 3 Bright 
			PWH4 JJJJJJJJJKKKKKKKKKLLLLLLLLLLLLL 3 Bright 
			Stop
	}
}
Actor GrenadeSparkNoHurt : EEProjectile
{
	Tag "Clown Grenade Debris"
	Radius 2
	Height 2
	Speed 17
	+Missile +NOTELEPORT
	scale 1
	damage (finaldamagedealt) // 8
	SeeSound ""
	DeathSound ""
	States
	{
		Spawn:
			CRZY R 1 Bright NoDelay
			{
				finaldamagedealt = 5 * random(1,8);
			}
			Goto Spawn
		Death:
			PWT2 G 3 Bright 
			PWT2 H 3 Bright 
			PWT2 IIIIIIIII 3 Bright 
			PWH4 JJJJJJJJJKKKKKKKKKLLLLLLLLLLLLL 3 Bright 
			Stop
	}
}

Actor GrenadeSpark2 : EEProjectile
{
	Tag "Clown Grenade Debris"
	Radius 2
	Height 2
	Speed 17
	+Missile +NOTELEPORT
	scale 1.5
	damage (finaldamagedealt) // 25
	SeeSound ""
	DeathSound ""
	States
	{
		Spawn:
			//CRZY R 2 Bright ThrustThing( (angle*random(-256,256))/360, 4, 0, 0)
			CRZY PQR 1 Bright NoDelay //A_CustomMissile("cloud", 4, 0, 0, 1)  
			{
				finaldamagedealt = 5 * random(1,8);
			}
			Goto Spawn
		Death:
			PWT2 G 3 Bright 
			PWT2 H 3 Bright 
			PWT2 I 3 Bright 
			Stop
	}
}
Actor GrenadeSpark2NoHurt : EEProjectile
{
	Tag "Clown Grenade Debris"
	Radius 2
	Height 2
	Speed 17
	+Missile +NOTELEPORT
	scale 1.5
	damage (finaldamagedealt) // 25
	SeeSound ""
	DeathSound ""
	States
	{
		Spawn:
			CRZY PQR 1 Bright NoDelay
			{
				finaldamagedealt = 5 * random(1,8);
			}
			Goto Spawn
		Death:
			PWT2 G 3 Bright 
			PWT2 H 3 Bright 
			PWT2 I 3 Bright 
			Stop
	}
}

actor Popcorn1 : EEProjectile
{
	Tag "Popcorn Shot"
	Radius 8
	Height 6
	Speed 20
	Damage (finaldamagedealt) // 5
	scale 0.25
	PROJECTILE
	ALPHA 0.8
	SeeSound ""
	DeathSound ""
	States
	{
		Spawn:
			PCRN ABCDEFGH 2 NoDelay
			{
				finaldamagedealt = 5 * random(1,8);
			}
			Goto Spawn
		Death:
			PCRN A 0 A_CustomMissile("Popcorn_Shrap1", 2, 0, random(-180, 180), 2, random(0, 180))
			PCRN A 0 A_Gravity
			PCRN A 0 A_CustomMissile("Popcorn_Shrap2", 2, 0, random(-180, 180), 2, random(0, 180))
			PCRN A 0 A_CustomMissile("Popcorn_Shrap6", 2, 0, random(-180, 180), 2, random(0, 180))
			PCRN A 0 A_Scream
			PCRN A 1 A_Jump (250,2)
			PCRN A 0 A_CustomMissile("CrawlingPopcorn", 16, 0, 0, 1)
			Stop
			PCRN A 1
			Stop
	}
}
actor Popcorn11 : Popcorn1
{
	Tag "Popcorn Shot"
	Mass 5
	States
	{
		Spawn:
			PCRN HGFEDCBA 2 NoDelay
			{
				finaldamagedealt = 5 * random(1,8);
			}
			PCRN A 0 A_Jump (128,2)
			PCRN A 0 A_Gravity
			PCRN A 1 
			{
				finaldamagedealt = 5 * random(1,8);
			}
			PCRN A 0 A_Jump (8,2)
			PCRN A 0 A_NoGravity
			PCRN HGFEDCBA 2 
			{
				finaldamagedealt = 5 * random(1,8);
			}
			Goto Spawn
		Death:
			PCRN A 0 A_CustomMissile("Popcorn_Shrap3", 2, 0, random(-180, 180), 2, random(0, 180))
			PCRN A 0 A_Gravity
			PCRN A 0 A_CustomMissile("Popcorn_Shrap1", 2, 0, random(-180, 180), 2, random(0, 180))
			PCRN A 0 A_CustomMissile("Popcorn_Shrap2", 2, 0, random(-180, 180), 2, random(0, 180))
			PCRN A 0 A_Scream
			PCRN A 1
			Stop
	}
}
actor Popcorn2 : Popcorn1
{
	Tag "Popcorn Shot"
	Scale 0.3
	States
	{
		Spawn:
			PCCN ABCDEFGH 2 NoDelay
			{
				finaldamagedealt = 5 * random(1,8);
			}
			PCCN A 0 A_Jump (64,2)
			PCCN ABCDEFGH 2	
			{
				finaldamagedealt = 5 * random(1,8);
				A_BishopMissileWeave;
			}
			PCCN ABCDEFGH 2 
			{
				finaldamagedealt = 5 * random(1,8);
			}
			Goto Spawn
		Death:
			PCCN A 0 A_CustomMissile("Popcorn_Shrap4", 2, 0, random(-180, 180), 2, random(0, 180))
			PCCN A 0 A_Gravity
			PCCN A 0 A_CustomMissile("Popcorn_Shrap5", 2, 0, random(-180, 180), 2, random(0, 180))
			PCCN A 0 A_CustomMissile("Popcorn_Shrap6", 2, 0, random(-180, 180), 2, random(0, 180))
			PCCN A 0 A_Scream
			PCCN A 1
			Stop
	}
}
actor Popcorn3 : Popcorn1
{
	Tag "Popcorn Shot"
	States
	{
		Spawn:
			PCCC HGFEDCBA 2 NoDelay
			{
				finaldamagedealt = 5 * random(1,8);
			}
			PCCC A 0 A_Jump (128,2)
			PCCC A 0 A_Gravity
			PCCC H 1 
			{
				finaldamagedealt = 5 * random(1,8);
			}
			PCCC A 0 A_Jump (8,2)
			PCCC A 0 A_NoGravity
			PCCC HGFEDCBA 2 
			{
				finaldamagedealt = 5 * random(1,8);
			}
			Goto Spawn
		Death:
			PCCC A 0 A_CustomMissile("Popcorn_Shrap1", 2, 0, random(-180, 180), 2, random(0, 180))
			PCCC A 0 A_Gravity
			PCCC A 0 A_CustomMissile("Popcorn_Shrap2", 2, 0, random(-180, 180), 2, random(0, 180))
			PCCC A 0 A_CustomMissile("Popcorn_Shrap6", 2, 0, random(-180, 180), 2, random(0, 180))
			PCCC A 0 A_Scream
			PCCC A 0
			Stop
	}
}

actor BurntPopcorn1 : EEProjectile
{
	Tag "Burnt Popcorn Shot"
	Radius 8
	Height 6
	Speed 14
	Damage (finaldamagedealt) // 5
	scale 0.25
	+LOWGRAVITY 
	PROJECTILE
	ALPHA 0.8
	SeeSound ""
	DeathSound ""
	States
	{
		Spawn:
			PBRN HGFEDCBA 2 NoDelay
			{
				finaldamagedealt = 5 * random(1,8);
			}
			PBRN A 0 A_Jump (96,2)
			PBRN A 0 A_Gravity
			PBRN H 1 
			{
				finaldamagedealt = 5 * random(1,8);
			}
			PBRN A 0 A_Jump (8,2)
			PBRN A 0 A_NoGravity
			PBRN HGFEDCBA 2 
			{
				finaldamagedealt = 5 * random(1,8);
			}
			Goto Spawn
		Death:
			PBRN A 4 A_Gravity
			PBRN A 4 A_Scream
			PBRN AAAA 1
			Stop
	}
}
ACTOR CrawlingPopcorn : EEBaseZSC 4815
{
	Health 5
	Radius 2
	Height 2
	Speed 1
	Mass 20
	PainChance 200
	//MONSTER 
	+FLOORCLIP +RANDOMIZE
	+LOOKALLAROUND
	-COUNTKILL
	scale 0.25
	MELEEDAMAGE 1
	SeeSound "POPC"
	PainSound "POPC"
	DeathSound "POPC"
	ActiveSound "POPC"
	MeleeSound ""
	Obituary "%o duh" 
	States
	{
		Spawn:
			CRWL A 4 A_Look
			Loop
		See:
			CRWL A 0
			{
				if (random(1,512) == 1) { return state("Evolve"); }
				return state("");
			}
			CRWL A 0 A_Jump (32,"See2")
			CRWL ABCB 5 A_Wander
			goto See
		See2:
			CRWL ABCB 5 
			CRWL A 1 A_StartSound("POPC")
			CRWL A 0 A_Jump (3,"Death")
			goto See
		Pain:
			CRWL A 8 A_Pain 
			Goto See 
		Melee:
			CRWL C 0
			Goto See 
		Death:
			CRWL ABCBABCBABCABCBABCBABC  1
			CRWL ABCBABCBABCABCBABCBABC  2
			CRWL ABCBABCBABCABCBABCBABC  3
			CRWL ABCBABCBABCABCBABCBA  4
			CRWL ABCBABCBABCABCBABC  5
			CRWL ABCBABCBABCBABCB 7
			CRWL ABCBABCBABCBA 9
			CRWL ABCBABCBABC 13
			CRWL ABCBABCBA 15
			CRWL ABCBABC 17
			CRWL ABCBA 19
			CRWL ABC 21
			CRWL AAAAAAAA 16
			Stop 
		Evolve:
			CRWL A 0
			{
				A_StartSound("Popcorn/Steam",CHAN_AUTO,frandom(0.75,1.25),0,ATTN_NORM,0,frandom(0.75,1.25));
			}
			CRWL A 8 A_CustomMissile("cloud1", 12, 0, 0, 1)
			CRWL A 8 A_CustomMissile("cloud1", 12, 0, 1)
			CRWL A 8 
			{
				A_CustomMissile("cloud1", 12, 0, 0, 1);
				user_random = random(1,32);
			}
			CRWL A 0
			{
				if (user_random <= 31) 
				{ 
					A_StartSound("Popcorn/Pop2",CHAN_7,frandom(0.75,1.00),0,ATTN_NORM,0,frandom(0.75,1.25));
					A_SpawnItemEx("BabyClown2New",0,0,0,0,0,0,0,SXF_TRANSFERAMBUSHFLAG | SXF_NOCHECKPOSITION | SXF_TRANSFERSPECIAL,0,tid); 
				}
				else
				{
					A_StartSound("Popcorn/Pop1",CHAN_7,frandom(0.75,1.00),0,ATTN_NORM,0,frandom(0.75,1.25));
				}
				A_Destroy;
			}
			stop
	}
}
ACTOR CrawlingPopcorn2 : CrawlingPopcorn 4824 //doesn't die off
{
	States
	{
		Spawn:
			CRWL A 4 A_Look
			Loop
		See:
			CRWL A 0
			{
				if (random(1,2048) == 1) { return state("Evolve"); }
				return state("");
			}
			CRWL A 0 A_Jump (32,"See2")
			CRWL ABCB 5 A_Wander
			goto See
		See2:
			CRWL ABCB 5 
			CRWL A 1 A_StartSound("POPC")
			goto See
		Pain:
			CRWL A 8 A_Pain 
			Goto See 
		Melee:
			CRWL C 0
			Goto See 
		Death:
			CRWL ABCBABCBABCABCBABCBABC  1
			CRWL ABCBABCBABCABCBABCBABC  2
			CRWL ABCBABCBABCABCBABCBABC  3
			CRWL ABCBABCBABCABCBABCBA  4
			CRWL ABCBABCBABCABCBABC  5
			CRWL ABCBABCBABCBABCB 7
			CRWL ABCBABCBABCBA 9
			CRWL ABCBABCBABC 13
			CRWL ABCBABCBA 15
			CRWL ABCBABC 17
			CRWL ABCBA 19
			CRWL ABC 21
			CRWL AAAAAAAA 16
			Stop 
		Evolve:
			CRWL A 0
			{
				A_StartSound("Popcorn/Steam",CHAN_AUTO,frandom(0.75,1.25),0,ATTN_NORM,0,frandom(0.75,1.25));
			}
			CRWL A 8 A_CustomMissile("cloud1", 12, 0, 0, 1)
			CRWL A 8 A_CustomMissile("cloud1", 12, 0, 1)
			CRWL A 8 
			{

				A_CustomMissile("cloud1", 12, 0, 0, 1);
				user_random = random(1,8);
			}
			CRWL A 1
			{
				if (user_random <= 7) 
				{ 
					A_StartSound("Popcorn/Pop2",CHAN_7,frandom(0.75,1.00),0,ATTN_NORM,0,frandom(0.75,1.25));
					A_SpawnItemEx("BabyClown2New",0,0,0,0,0,0,0,SXF_TRANSFERAMBUSHFLAG | SXF_NOCHECKPOSITION | SXF_TRANSFERSPECIAL,0,tid); 
				}
				else
				{
					A_StartSound("Popcorn/Pop1",CHAN_7,frandom(0.75,1.00),0,ATTN_NORM,0,frandom(0.75,1.25));
				}
				
				A_Destroy;
			}
			stop
	}
}

